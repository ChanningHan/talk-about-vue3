# å†™åœ¨å¼€å¤´

>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯**Channing**ã€‚<br><br>
>ä¸Šå‘¨äº”åˆšåœ¨éƒ¨é—¨é‡Œåšå®Œäº†å…³äºVue3çš„æŠ€æœ¯åˆ†äº«ï¼Œå‰åå¤§æ¦‚èŠ±äº†æ•´æ•´ä¸€ä¸ªæ˜ŸæœŸçš„æ—¶é—´å’Œç²¾åŠ›å»å‡†å¤‡é‡Œé¢çš„å†…å®¹ï¼Œé‚æƒ³åœ¨å‘¨æœ«çš„æ—¶é—´é‡ŒæŠŠè¿™äº›é‡æ–°å†æ•´ç†æˆæ–‡å­—ä¹Ÿåˆ†äº«ç»™æ˜å‹ä»¬ã€‚<br><br>
>æˆ–è®¸æœ‰äº›éƒ¨åˆ†ä¸ç»å¯¹ä¸“ä¸šï¼Œä½†ç»å¯¹ä¹äºæ¥å—åˆç†çš„æ„è§å’Œå»ºè®®ã€‚<br><br>
>æœ¬æ–‡ä¸»ä½“è„‰ç»œåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š**`Vue3é‡å†™çš„åŠ¨æœº`**ã€**`ä¼˜åŒ–çš„åŸç†`**ï¼Œä»¥åŠVue3å¸¦æ¥äº†ä»€ä¹ˆ **`å€¼å¾—ä¸€çœ‹çš„æ–°ä¸œè¥¿`**ã€‚<br><br>
>å†…å®¹æ–¹é¢å…·ä½“çš„åˆ’åˆ†ä¸ºå¦‚ä¸‹è„‘å›¾æ‰€ç¤ºï¼š
>![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a0e368b335d14e2cb4f785cf7f7e82b4~tplv-k3u1fbpfcp-watermark.image)






# Whyâ€”â€”é‡å†™çš„åŠ¨æœºï¼Ÿ

æ›´ä¸“ä¸šå¯è§å°¤å¤§äº²ç¬”ï¼š[The process: Making Vue 3](https://increment.com/frontend/making-vue-3)

é‡å†™çš„åŠ¨æœºä¸»è¦åˆ†ä¸ºä¸¤ç‚¹ï¼š

1. **ä½¿ç”¨æ–°çš„JSåŸç”Ÿç‰¹æ€§**
2. **è§£å†³è®¾è®¡å’Œä½“ç³»æ¶æ„çš„ç¼ºé™·**

##  ä½¿ç”¨æ–°çš„JSåŸç”Ÿç‰¹æ€§

éšç€å‰ç«¯æ ‡å‡†åŒ–çš„å‘å±•ï¼Œç›®å‰ä¸»æµæµè§ˆå™¨å¯¹å¾ˆå¤šJSæ–°ç‰¹æ€§éƒ½æ™®éæ”¯æŒäº†ï¼Œå…¶ä¸­ä¸€äº›æ–°ç‰¹æ€§ä¸ä»…è§£å†³äº†å¾ˆå¤šæŠ€æœ¯ä¸Šçš„å®ç°éš¾é¢˜ï¼Œè¿˜å¸¦æ¥äº†æ›´å¥½çš„æ€§èƒ½æå‡ã€‚

åœ¨Vue3ä¸­ï¼Œæœ€é‡è¦ä¹Ÿæ›´ä¸ºäººæ‰€çŸ¥çš„å°±æ˜¯ES6çš„**Proxy**ã€‚

Proxyä¸ä»…æ¶ˆé™¤äº†Vue2ä¸­ç°æœ‰çš„é™åˆ¶ï¼ˆæ¯”å¦‚å¯¹è±¡æ–°å±æ€§çš„å¢åŠ ã€æ•°ç»„å…ƒç´ çš„ç›´æ¥ä¿®æ”¹ä¸ä¼šè§¦å‘å“åº”å¼æœºåˆ¶ï¼Œè¿™ä¹Ÿæ˜¯å¾ˆå¤šæ–°æ‰‹ä»¥ä¸ºæ‰€è°“çš„bugï¼‰ï¼Œè€Œä¸”æœ‰ç€æ›´å¥½çš„æ€§èƒ½ï¼š

æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨Vue2ä¸­å¯¹æ•°æ®çš„ä¾¦å¬åŠ«æŒæ˜¯åœ¨ç»„ä»¶åˆå§‹åŒ–æ—¶å»éå†é€’å½’ä¸€ä¸ªå¯¹è±¡ï¼Œç»™å…¶ä¸­çš„æ¯ä¸€ä¸ªå±æ€§ç”¨Object.definePropertyè®¾ç½®å®ƒçš„getterå’Œsetterï¼Œç„¶åå†æŠŠå¤„ç†å¥½çš„è¿™äº›å¯¹è±¡æŒ‚åˆ°ç»„ä»¶å®ä¾‹çš„thisä¸Šé¢ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼çš„æ•°æ®ä¾¦å¬æ˜¯åœ¨å±æ€§å±‚é¢çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¢åŠ å¯¹è±¡å±æ€§æ— æ³•è¢«ç›‘å¬çš„åŸå› ï¼ŒåŒæ—¶è¿™ç§åˆå§‹åŒ–çš„æ“ä½œå¯¹äºCPUæ¥è¯´è¿˜æ˜¯æ¯”è¾ƒæ˜‚è´µçš„ä¸€ä¸ªæ“ä½œã€‚å¯¹äºjavascriptè€Œè¨€ï¼Œä¸€ä¸ªå¯¹è±¡è‚¯å®šè¶Šç¨³å®šè¶Šå°æ€§èƒ½å°±è¶Šå¥½ã€‚

ä½¿ç”¨Proxyä¹‹åç»„ä»¶çš„åˆå§‹åŒ–å°±ä¸éœ€è¦è¿™ä¹ˆåšè¿™ä¹ˆè´¹æ—¶çš„æ“ä½œäº†ï¼Œå› ä¸ºProxyå°±æ˜¯çœŸæ­£æ„ä¹‰ç»™ä¸€ä¸ªå¯¹è±¡åŒ…ä¸Šä¸€å±‚ä»£ç†ä»è€Œå»å®Œæˆæ•°æ®ä¾¦å¬åŠ«æŒçš„æ“ä½œï¼Œæ‰€ä»¥æ€»çš„æ¥è¯´è¿™ä¸ªå¤æ‚åº¦æ˜¯ç›´æ¥å°‘äº†ä¸€ä¸ªæ•°é‡çº§çš„ã€‚åªè¦ä½ å¯¹è¿™ä¸ªä»£ç†åçš„å¯¹è±¡è®¿é—®æˆ–ä¿®æ”¹é‡Œé¢çš„ä¸œè¥¿éƒ½èƒ½è¢«è¿™å±‚ä»£ç†æ‰€æ„ŸçŸ¥åˆ°ï¼Œè¿›è€Œå»åŠ¨æ€åœ°å†³å®šè¿”å›ä»€ä¹ˆä¸œè¥¿ç»™ä½ ï¼Œå¹¶ä¸”ä¹Ÿä¸å†éœ€è¦æŠŠé€‰é¡¹çš„è¿™äº›ä¸œè¥¿å†é‡å¤æŒ‚åˆ°ç»„ä»¶å®ä¾‹çš„thisä¸Šé¢ï¼Œå› ä¸ºä½ è®¿é—®çš„æ—¶å€™æ˜¯æœ‰è¿™ä¸ªä¿¡æ¯çŸ¥é“ä½ è®¿é—®çš„ä¸œè¥¿æ˜¯å±äºpropsè¿˜æ˜¯dataè¿˜æ˜¯å…¶ä»–çš„ï¼Œvueåªéœ€è¦æ ¹æ®è¿™ä¸ªä¿¡æ¯å»å¯¹åº”çš„æ•°æ®ç»“æ„é‡Œé¢æ‹¿å‡ºæ¥å°±å¯ä»¥äº†ï¼Œå•å°±è¿™ä¸€ç‚¹è€Œè¨€ä½ å°±å¯ä»¥æ„Ÿè§‰åˆ°ç»„ä»¶çš„å†…å­˜å ç”¨å·²ç»å°‘äº†ä¸€åŠã€‚

ç”±äºproxyæ˜¯åœ¨å¯¹è±¡å±‚é¢ä¸Šçš„ä»£ç†ï¼Œæ‰€ä»¥ä½ åœ¨å¯¹è±¡ä¸Šæ–°å¢å±æ€§æ˜¯å¯ä»¥è¢«ä»£ç†åˆ°çš„ã€‚

å¦å¤–Proxyè¿˜å¯ä»¥ä»£ç†æ•°ç»„ï¼Œæ‰€ä»¥å°±ç®—ä½ ç›´æ¥ä¿®æ”¹æ•°ç»„é‡Œé¢çš„å…ƒç´ ä¹Ÿæ˜¯å¯ä»¥è¢«ä»£ç†åˆ°çš„ã€‚

ä½†æ˜¯ï¼Œå¯¹äºä¼ ç»Ÿçš„æµè§ˆå™¨â€”â€”IEï¼Œå°±è¿IE11ä¹Ÿè¿˜æ²¡æœ‰æ”¯æŒProxyè¿™ä¸ªä¸œè¥¿ï¼Œåˆç”±äºProxyæ˜¯åŸç”Ÿçš„ES6ç‰¹æ€§ï¼Œæ‰€ä»¥ç›®å‰è¿˜æ— æ³•é€šè¿‡polyfillæ¥å…¼å®¹IEï¼ˆVue3ä¹Ÿæ­£åœ¨åšè¿™ä¸€å—çš„å…¼å®¹ï¼‰.....è¿™ä¸ªä¸œè¥¿ä¹Ÿç¡®å®æ‹¿ä»–æ²¡è¾™ï¼Œå¦åˆ™å½“åˆReactå‡çº§åˆ°15ã€Vue2.Xä¹Ÿä¸ä¼šæŠ›å¼ƒIE8äº†ã€‚å°¤å¤§åœ¨å»å¹´çš„VueConfä¸Šè¿˜å¾ˆå½¢è±¡åœ°åæ§½äº†IEâ€”â€”ç™¾è¶³ä¹‹è™«ï¼Œæ­»è€Œä¸åƒµã€‚

IEè€—å­å°¾æ±å§ã€‚

## è§£å†³è®¾è®¡å’Œä½“ç³»æ¶æ„çš„ç¼ºé™·

éšç€Vue2ä½¿ç”¨å’Œç»´æŠ¤è¿‡ç¨‹ï¼Œé€æ¸æš´éœ²å‡ºæ¥äº†ä¸€äº›è®¾è®¡å’Œä½“ç³»æ¶æ„ä¸Šçš„ç¼ºé™·ï¼Œä¸»è¦æœ‰ï¼š

1. æ¡†æ¶å†…éƒ¨æ¨¡å—çš„è€¦åˆé—®é¢˜
2. TypeScriptçš„æ”¯æŒä¸å¥½
3. å¯¹äºå¤§è§„æ¨¡åº”ç”¨çš„å¼€å‘ä½“éªŒä¸å¥½

é‚£ä¹ˆåœ¨Vue3ä¸­æ˜¯å¦‚ä½•é€ä¸€è§£å†³è¿™äº›é—®é¢˜çš„ï¼Ÿ

### 1. è§£è€¦å†…éƒ¨åŒ…

é¦–å…ˆï¼Œçœ‹è¿‡Vue2æºç çš„æœ‹å‹ä»¬åº”è¯¥æ¯”è¾ƒæ·±æœ‰æ„Ÿè§¦ï¼Œå•ä¸€åœ°ç†è§£æ¡†æ¶æºç æ˜¯éå¸¸ç—›è‹¦çš„ã€‚

è¿™ä¸ªè¡¨ç°ä¸ºå„ä¸ªæ¨¡å—å†…éƒ¨çš„é«˜åº¦è€¦åˆå’Œçœ‹ä¸Šå»ä¼¼ä¹ä¸å±äºä»»ä½•åœ°æ–¹çš„æµ®åŠ¨ä»£ç çš„éšå¼è€¦åˆï¼Œè¿™ä¹Ÿè®©æºç çš„ç»´æŠ¤å’Œæ‰©å±•åœ¨ç¤¾åŒºä¸­å˜å¾—å›°éš¾é‡é‡ã€‚

ä¹Ÿç”±äºå†…éƒ¨æ¨¡å—çš„è€¦åˆï¼Œå¯¹äºä¸€äº›èµ„æ·±çš„é«˜çº§ç”¨æˆ·ï¼ˆæ¯”å¦‚åº“ä½œè€…ï¼‰åœ¨æ„å»ºæ›´é«˜çº§åˆ«çš„æ¸²æŸ“å™¨æ—¶ä¸å¾—ä¸æŠŠæ•´ä¸ªæ¡†æ¶çš„ä»£ç å¼•å…¥è¿›æ¥ã€‚æˆ‘ä»¬åœ¨çœ‹Vue2æºç çš„æ—¶å€™æˆ–è®¸ä¼šæ³¨æ„åˆ°é‡Œé¢è¿˜æœ‰Weexï¼Œè¿™ä¸ªæ˜¯ç”±äºWeexæ˜¯ä¸Vueå®˜æ–¹åˆä½œçš„ä¸€ä¸ªå¤šç«¯æ¸²æŸ“æ¡†æ¶ï¼Œè€ŒVue2ä¸­ä¸ºäº†æ”¯æŒè¿™ä¸ªèƒ½åŠ›åˆå—é™äºç°æœ‰æ¶æ„ï¼Œä¸å¾—ä¸åˆ†å‰ä»£ç åº“å¹¶ä¸”å¤åˆ¶å¤§é‡çš„æ¡†æ¶ä»£ç è¿›å»ï¼Œæ›´æƒ¨çš„åƒmpVueè¿™ç§éå®˜æ–¹åˆä½œçš„ï¼Œå°±åªèƒ½æ‰‹åŠ¨æ‹‰æ•´ä¸ªVueçš„åˆ†æ”¯ä»£ç ä¸‹æ¥ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒVue3é‡å†™æ—¶é‡‡ç”¨äº†**monorepo**çš„è®¾ç½®ï¼ŒæŠŠåŸæ¥çš„å„ä¸ªæ¨¡å—æ‹†åˆ†å‡ºæ¥ï¼Œæ•´ä¸ªæ¡†æ¶å†ç”±è¿™äº›ä½è€¦åˆçš„å†…éƒ¨åŒ…ç»„æˆï¼Œæ¯ä¸ªåŒ…éƒ½æœ‰è‡ªå·±çš„APIã€ç±»å‹å®šä¹‰ã€æµ‹è¯•ç¨‹åºç­‰ç­‰ã€‚ä¸€æ–¹é¢è®©å¼€å‘äººå‘˜å¯ä»¥æ›´å®¹æ˜“åœ°é˜…è¯»ã€ç†è§£ç”šè‡³å¯ä»¥æ”¾å¿ƒåœ°å¤§èŒƒå›´ä¿®æ”¹è¿™äº›æ¨¡å—åŒ…ã€‚

å¦ä¸€æ–¹é¢è¿˜ç»™äºˆäº†ç”¨æˆ·å°†å…¶ä¸­çš„ä¸€äº›åŒ…å•ç‹¬æ‹¿å‡ºå»ç”¨çš„èƒ½åŠ›ï¼Œæ¯”å¦‚ä½ å¯ä»¥æŠŠ**reactivity**è¿™ä¸ªåŒ…ä¹Ÿå°±æ˜¯å“åº”å¼ç³»ç»Ÿæ‹¿å‡ºå»ç”¨äºéœ€è¦ç”¨åˆ°å“åº”å¼çš„åœºæ™¯ï¼Œä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªåŒ…å»æ­ä¸€ä¸ªè‡ªå·±çš„ç©å…·æ¡†æ¶ç­‰ç­‰éƒ½æ˜¯å¯ä»¥çš„ã€‚



### 2.ä½¿ç”¨TypeScripté‡å†™ä»¥åŠè®¾è®¡ç±»å‹å‹å¥½çš„æ–°API

è®²åˆ°**TypeScript**ï¼Œè¿™åº”è¯¥ä¹Ÿæ˜¯æˆ‘ä»¬æ¯”è¾ƒå…³æ³¨çš„ä¸€ä¸ªé—®é¢˜ã€‚

é¦–å…ˆVue2æœ€åˆæ˜¯ä½¿ç”¨çº¯JSå†™æˆçš„ï¼Œä½†åæ¥æ„è¯†åˆ°ä¸€ä¸ªç±»å‹ç³»ç»Ÿå°†å¯¹è¿™æ ·å¤§å‹è§„æ¨¡çš„é¡¹ç›®æ˜¯éå¸¸å¿…è¦çš„ï¼Œå°¤å…¶ä½“ç°åœ¨é‡æ„æˆ–è€…æ‰©å±•ï¼Œç±»å‹æ£€æŸ¥å°†å¾ˆå¤§ç¨‹åº¦åœ°å‡å°‘è¿™ä¸ªè¿‡ç¨‹ä¸­å¼•å…¥æ„å¤–é”™è¯¯çš„æœºä¼šï¼Œä¹Ÿè®©æ›´å¤šä»£ç è´¡çŒ®è€…å¯ä»¥æ›´å¤§èƒ†æ”¾å¿ƒåœ°è¿›è¡Œå¤§èŒƒå›´çš„æ›´æ”¹ã€‚

æ‰€ä»¥Vue2å½“æ—¶å¼•å…¥äº†Fackbookçš„**Flow**è¿›è¡Œé™æ€ç±»å‹æ£€æŸ¥ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸ºå®ƒå¯ä»¥æ¸è¿›åœ°æ·»åŠ åˆ°ç°æœ‰çš„çº¯JSé¡¹ç›®ä¸­ï¼Œä½†å¯æƒœçš„æ˜¯Flowè™½ç„¶æœ‰ä¸€å®šçš„å¸®åŠ©ä½†æ˜¯å¹¶æ²¡æœ‰æœŸæœ›ä¸­é‚£ä¹ˆé¦™ï¼Œæœ€ç¦»è°±çš„æ˜¯è°èƒ½æƒ³åˆ°è¿Flowè‡ªå·±ä¹Ÿéƒ½çƒ‚å°¾äº†ï¼Œå¯ä»¥ä¸ŠFlowçš„å®˜ç½‘çœ‹çœ‹ï¼Œè¿™ç©æ„åˆ°ç°åœ¨è¿˜æ˜¯0.Xçš„ç‰ˆæœ¬ï¼Œç›¸æ¯”TypeScriptçš„é£é€Ÿå‘å±•ä»¥åŠTSä¸å¼€å‘å·¥å…·çš„æ·±åº¦é›†æˆå°¤å…¶æ˜¯VSCodeï¼ŒFlowçœŸçš„æ˜¯ä¸€è¨€éš¾å°½å¥½å§ã€‚ä¸å¯å¦è®¤ï¼Œå°¤å¤§è‡ªå·±ä¹Ÿè¯´è‡ªå·±å½“åˆæ˜¯å‹é”™å®äº†ã€‚

ä¹Ÿç”±äºTSçš„è“¬å‹ƒå‘å±•ï¼Œè¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·ä¹Ÿåœ¨Vueä¸­ä½¿ç”¨TSï¼Œè€Œå¯¹Vueæ¥è¯´ï¼ŒåŒæ—¶æ”¯æŒä¸¤ä¸ªç±»å‹ç³»ç»Ÿæ˜¯ä¸€ä»¶æ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…ï¼Œå¹¶ä¸”åœ¨ç±»å‹æ¨å¯¼ä¸Šå˜å¾—éå¸¸å›°éš¾ã€‚å¦‚æœæºä»£ç åˆ‡æ¢åˆ°TSä¹Ÿå°±æ²¡é‚£ä¹ˆå¤šå±äº‹äº†ã€‚

å…¶æ¬¡ï¼Œä¹‹æ‰€ä»¥Vue2å¯¹TSçš„æ”¯æŒä¸€å¡Œç³Šæ¶‚ï¼Œä¹Ÿæ˜¯å› ä¸º**Options API**ä¸ç±»å‹ç³»ç»Ÿä¹‹é—´æ˜¯å­˜åœ¨**æ–­å±‚**çš„ã€‚

Vueçš„APIè®¾è®¡å¼€å§‹å¹¶æ²¡æœ‰é’ˆå¯¹è¯­è¨€æœ¬èº«çš„æœºåˆ¶å’Œç±»å‹ç³»ç»Ÿå»è®¾è®¡ï¼Œéƒ¨åˆ†åŸå› ä¹Ÿæ˜¯Vueå¼€å§‹å†™çš„æ—¶å€™jsä¸­ç”šè‡³è¿˜æ²¡æœ‰ç±»å‹ç³»ç»Ÿè¿™ä¸ªç©æ„ã€‚

vueç»„ä»¶å®ä¾‹æœ¬è´¨ä¸Šå°±æ˜¯ä¸ªåŒ…å«äº†ä¸€ä¸ªä¸ªæè¿°ç»„ä»¶é€‰é¡¹å±æ€§çš„å¯¹è±¡ï¼Œè¿™ç§è®¾è®¡çš„å¥½å¤„å°±æ˜¯æ›´ç¬¦åˆäººç±»çš„ç›´è§‰ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®ƒå¯¹äºæ–°æ‰‹æ¥è¯´æ›´å¥½ç†è§£å’Œå®¹æ˜“ä¸Šæ‰‹ã€‚

ä½†æ˜¯è¿™ç§è®¾è®¡çš„ç¼ºé™·å°±æ˜¯è·ŸTypeScriptè¿™æ ·çš„ç±»å‹ç³»ç»Ÿå­˜åœ¨ä¸€ä¸ªâ€œæ–­å±‚â€ï¼Œè¿™ä¸ªæ–­å±‚æ€ä¹ˆè¯´å‘¢ï¼Œå¯¹äºä¸ç”¨ç±»å‹ç³»ç»Ÿåªå…³æ³¨ä¸šåŠ¡é€»è¾‘çš„ç”¨æˆ·æ¥è¯´æ˜¯æ„ŸçŸ¥ä¸åˆ°çš„ã€‚

Vue2ä¸­çš„optionsAPIæ˜¯ä¸€ä¸ªçœ‹ä¼¼é¢å‘å¯¹è±¡ä½†æ˜¯å®é™…ä¸Šå´æœ‰ä¸€å®šåå·®ï¼Œè¿™å°±å¯¼è‡´äº†å®ƒä¸å¤Ÿç±»å‹å‹å¥½ï¼Œå°¤å…¶æ˜¯å¯¹äºé€‰é¡¹æ¥è¯´ï¼Œç±»å‹æ¨å¯¼æ˜¯æ¯”è¾ƒå›°éš¾çš„ã€‚

ä½†è¿™ä¸ªæ–­å±‚å…¶å®ä¹Ÿæ˜¯åŒå‘çš„ï¼šä½ å¯ä»¥è¯´æ˜¯optionsAPIçš„è®¾è®¡ä¸å¤Ÿç±»å‹å‹å¥½ï¼Œä¹Ÿå¯ä»¥è¯´TSè¿˜ä¸å¤Ÿå¼ºå¤§ä¸èƒ½ç»™Vueæä¾›è¶³å¤Ÿå¥½çš„ç±»å‹æ”¯æŒã€‚

ä¸¾ä¸ªæ —å­ï¼Œæ­£å¦‚**JSX**ä¸€å¼€å§‹ä¹Ÿæ˜¯æ²¡æœ‰ç±»å‹æ”¯æŒçš„ï¼Œå®Œå…¨æ˜¯å› ä¸ºTypeScriptå¼ºè¡Œç»™åŠ äº†ä¸€æ•´å¥—é’ˆå¯¹JSXçš„ç±»å‹æ¨å¯¼æœºåˆ¶æ‰ç»™äº†TSXç°åœ¨çš„å¼€å‘ä½“éªŒã€‚æ‰€ä»¥å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œå¦‚æœTypeScriptå½“æ—¶å› ä¸ºJSXä¸å±äºçœŸæ­£çš„JSè§„èŒƒè€Œä¸ç»™å®ƒæä¾›æ”¯æŒï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥è¯´Reactçš„è®¾è®¡è·Ÿç±»å‹ç³»ç»Ÿå­˜åœ¨ç€æ–­å±‚å‘¢ï¼Ÿ

é‚£ä¹ˆå¦‚ä½•åœ¨Vueä¸­å»æŠ¹å¹³è¿™ä¸ªæ–­å±‚å‘¢ï¼Ÿä¸€ä¸ªå¾ˆç›´æ¥çš„æ–¹æ³•å°±æ˜¯é‡æ–°è®¾è®¡ä¸€ä¸ªç±»å‹å‹å¥½çš„APIã€‚è¿™ä¸ªæ–¹æ³•è¯´èµ·æ¥å¾ˆç®€å•ï¼Œä½†æ˜¯å¯¹Vueæ¥è¯´æ”¹ä¸€ä¸ªAPIæ˜¯éœ€è¦è€ƒè™‘å¾ˆå¤šä¸œè¥¿çš„ï¼š

1. ä¸åŸæœ‰APIçš„**å…¼å®¹æ€§**ï¼šèƒ½å¦åŒæ—¶æ”¯æŒæ–°æ—§APIï¼Ÿæ—§çš„ç”¨æˆ·åˆå¦‚ä½•å‡çº§ï¼ŸåƒAngular2å½“æ—¶é‚£æ ·ç›´æ¥æ”¹çš„é¢ç›®å…¨éå½“ç„¶æ¯”è¾ƒç®€å•ï¼Œä½†è¯´ç›´æ¥ç‚¹å°±æ˜¯ä¸ç®¡æ—§ç‰ˆæœ¬ç”¨æˆ·çš„æ­»æ´»ï¼Œä¸‹åœºå¤§å®¶ä¹Ÿæ¸…æ¥šã€‚ç°åœ¨ä¸»æµçš„æ¡†æ¶å¤§ç‰ˆæœ¬å‡çº§éƒ½å¼€å§‹åœ¨ç‰ˆæœ¬å…¼å®¹ä¸Šè¶³å¤Ÿé‡è§†æˆ–è€…ä¸‹äº†å¤§åŠŸå¤«ï¼Œæ¯”å¦‚åæœˆä»½æ­£å¼å‘å¸ƒçš„**React17**ï¼Œè¿™ä¸ªç‰ˆæœ¬æ²¡æœ‰ä»»ä½•æ–°çš„ç”¨æˆ·å±‚é¢çš„APIï¼Œä½†å…¶ä¸­ä¸€ä¸ªæœ‰æ„æ€çš„æ–°ç‰¹æ€§å°±æ˜¯è®©ä¸€ä¸ªReactåº”ç”¨å¯ä»¥åŒæ—¶åŠ è½½å¤šä¸ªReactç‰ˆæœ¬ï¼Œä½¿å¾—æ—§ç‰ˆæœ¬å¯ä»¥é€æ­¥å‡çº§ã€‚

2. å¦‚ä½•è®¾è®¡å‡ºæ—¢èƒ½æä¾›è‰¯å¥½çš„ç±»å‹æ¨å¯¼ï¼Œåˆä¸è®©ç±»å‹æ¨å¯¼è€Œåšçš„è®¾è®¡å½±å“åˆ°éTSç”¨æˆ·çš„å¼€å‘ä½“éªŒï¼Ÿå¦‚ä½•åœ¨TSå’ŒéTSçš„ä½¿ç”¨ä½“éªŒä¸­åšåˆ°ä¸€ä¸ªæœ€å¥½çš„**å¹³è¡¡**å’Œ**ä¸€è‡´æ€§**ï¼ŸåƒAngularé‚£æ ·ä¸ç®¡éTSçš„ç”¨æˆ·å½“ç„¶ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œä½†æ˜¯Vueä¸ä¼šè¿™ä¹ˆåšã€‚

æˆ‘ä»¬å›é¡¾ä¸€ä¸‹Vue2é‡Œé¢æ˜¯æ€ä¹ˆå»ä½¿ç”¨TypeScriptçš„ï¼š

åœ¨Vue2ä¸­ä½¿ç”¨è¿‡TypeScriptçš„è¯æˆ‘ä»¬åŸºæœ¬å¯¹è¿™ä¸¤ä¸ªç¤¾åŒºæ–¹æ¡ˆæ¯”è¾ƒç†Ÿæ‚‰äº†â€”â€”**vue-class-component**å’Œ**vue-property-decorator**ã€‚

è¿™ä¸¤ä¸ªæ–¹æ¡ˆéƒ½æ˜¯åŸºäº**Class**å®ç°çš„ï¼Œé‚£ä¹ˆVue3è¦åšåˆ°ç±»å‹å‹å¥½ï¼Œæ—¢ç„¶æœ‰äº†è¿™ä¹ˆæˆç†Ÿçš„ä¸¤ä¸ªç¤¾åŒºæ–¹æ¡ˆï¼Œåœ¨Vue3ä¸­ç»§ç»­æ²¿ç”¨è¿™ä¸ªæ–¹å‘ï¼ŒåŸºäºClassè®¾è®¡å‡ºä¸€ä¸ªæ›´å¥½ç”¨çš„APIä¸å°±ç®€å•å®Œäº‹äº†å—ï¼Ÿ

ç¡®å®ï¼Œåœ¨Vue3çš„åŸå‹é˜¶æ®µç”šè‡³å·²ç»å®ç°äº†æ–°çš„**Class API**ï¼Œä½†æ˜¯åé¢åˆæŠŠè¿™ä¸ªAPIç»™åˆ äº†ã€‚å› ä¸ºclassçš„æ°´çœŸçš„æ˜¯å¤ªæ·±äº†ã€‚

é¦–å…ˆï¼ŒClass APIä¾èµ–äºfieldsã€decoratorsç­‰ææ¡ˆï¼Œå°¤å…¶æ˜¯decoratorsçš„ææ¡ˆçœŸçš„æ˜¯å¤ªå¤šå‘äº†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹githubä¸Š**TC39**å…³äº**decoratorsææ¡ˆ**çš„è®¨è®ºå’Œè¿›åº¦ï¼š[https://github.com/tc39/proposal-decorators](https://github.com/tc39/proposal-decorators)ã€‚

è¿™ç©æ„ç›®å‰ä»æœ‰41ä¸ªåœ¨è®¨è®ºä¸­çš„issueï¼Œåœ¨å·²å…³é—­çš„167ä¸ªissueä¸­æ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯ä¹‹å‰**V8**å›¢é˜Ÿå‡ºäºæ€§èƒ½è€ƒè™‘ç›´æ¥å¦å†³æ‰äº†decoratorså…¶ä¸­çš„ä¸€ä¸ªææ¡ˆï¼Œæœ‰ä¸ªè€å“¥åœ¨åº•ä¸‹è¯„è®ºè¯´çƒçƒä¸è¦å› ä¸ºè¿™ä¸ªææ¡ˆä¹Ÿæ¨ç¿»ä¹‹å‰çš„ææ¡ˆï¼Œå› ä¸ºç¤¾åŒºä¸­å·²ç»æœ‰å¾ˆå¤šäººåœ¨ä½¿ç”¨äº†ï¼Œæ¯”å¦‚**Ember**ã€**Angular**ã€**Vue**ç­‰ç­‰ã€‚

è€Œdecoratorsæœ¬èº«ç»å†äº†è¿™ä¹ˆé•¿æ—¶é—´çš„äº‰è®ºï¼Œå·²ç»å¤§æ”¹äº†å¥½å‡ æ¬¡ï¼Œä½†ä¹Ÿä»ç„¶åœç•™åœ¨**stage2**çš„é˜¶æ®µï¼š

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8dfd6a354fc341b798c1001aecb4c901~tplv-k3u1fbpfcp-watermark.image)

stage2æ˜¯ä»€ä¹ˆæ¦‚å¿µï¼Ÿå¯ä»¥åœ¨TC39åœ¨Aboutä¸­è´´å‡ºæ¥çš„[æ–‡æ¡£]([tc39.github.io/process-document/](https://tc39.github.io/process-document/))ä¸­çœ‹åˆ°ï¼š

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fbabc61be2334b2097e8f45e23089f02~tplv-k3u1fbpfcp-watermark.image)

stage2æ„å‘³ç€è¿™ä¸ªææ¡ˆçš„ä¸œè¥¿éšæ—¶å¯èƒ½ä¼šå‘ç”Ÿç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼Œè‡³å°‘å¾—è¿›å…¥**stage3**é˜¶æ®µæ‰ä¸ä¼šå‡ºç°ç ´åæ€§çš„æ”¹åŠ¨ã€‚

é‚£ä¹ˆç°åœ¨TSé‡Œé¢çš„decoratorsè¿˜èƒ½ç”¨æ˜¯å› ä¸º**TS**å®ç°çš„æ˜¯decoratorsæ¯”è¾ƒæ—©æœŸçš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå·²ç»è·Ÿæœ€æ–°çš„decoratorsææ¡ˆè„±èŠ‚äº†ï¼ŒæœŸé—´decoratorsè¿˜ç»è¿‡äº†å‡ æ¬¡çš„å¤§æ”¹ã€‚

å¦å¤–ï¼ŒVueLoaderé‡Œé¢ç”¨çš„**Babel**å¯¹decoratorsçš„å®ç°å’Œ**TS**å¯¹decoratorsçš„å®ç°åˆæœ‰ä¸åŒï¼Œè¿™åœ¨ä¸€äº›æ¯”è¾ƒæç«¯çš„ç”¨ä¾‹é‡Œé¢å¯èƒ½å°±ä¼šè¸©å‘äº†ã€‚

æ‰€ä»¥å‡ºäºClassçš„**å¤æ‚æ€§**å’Œ**ä¸ç¡®å®šæ€§**ï¼Œè¿™ç©æ„åœ¨Vue3è¿˜æ˜¯æš‚æ—¶ä¸è€ƒè™‘äº†ï¼Œå¹¶ä¸”Class APIé™¤äº†ç¨å¾®å¥½ä¸€ç‚¹çš„ç±»å‹æ”¯æŒä»¥å¤–ä¹Ÿå¹¶æ²¡æœ‰å¸¦æ¥å…¶ä»–çš„å®ç”¨æ€§ã€‚ä½†æ˜¯ä¸ºäº†ç‰ˆæœ¬å…¼å®¹ï¼ŒVue3ä¸­ä¹Ÿ**ä»ç„¶ä¼šæ”¯æŒ**åˆšåˆšæåˆ°çš„ä¸¤ä¸ªç¤¾åŒºæ–¹æ¡ˆã€‚é‚£ä¹ˆæŠ›å¼ƒäº†Class APIï¼Œè¦æ€ä¹ˆå»æ‹¥æŠ±TypeScriptå‘¢ï¼Ÿ

äº‹å®ä¸ŠClassçš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¸€ä¸ªåŸºäº**function**çš„APIåŒæ ·å¯ä»¥åšåˆ°ç±»å‹å‹å¥½ï¼Œå¹¶ä¸”å¯ä»¥åšå¾—æ›´å¥½ï¼Œå°¤å…¶æ˜¯å‡½æ•°ä¸­çš„å‚æ•°å’Œè¿”å›å€¼éƒ½æ˜¯å¯¹ç±»å‹ç³»ç»Ÿéå¸¸å‹å¥½çš„ï¼Œå› æ­¤è¿™ä¸ªåŸºäºå‡½æ•°çš„APIå°±åº”è¿è€Œç”Ÿäº†ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨Vue3ä¸­çš„**Composition API**ã€‚



### 3. è§£å†³å¼€å‘å¤§è§„æ¨¡åº”ç”¨çš„éœ€æ±‚

éšç€Vueè¢«è¶Šæ¥è¶Šå¹¿æ³›åœ°é‡‡ç”¨ï¼Œå¼€å‘**å¤§å‹é¡¹ç›®**çš„éœ€æ±‚ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå¯¹äºè¿™ç§ç±»å‹çš„é¡¹ç›®ï¼Œé¦–å…ˆéœ€è¦çš„æ˜¯ä¸€ä¸ªåƒ**TypeScript**è¿™æ ·çš„ç±»å‹ç³»ç»Ÿï¼Œè¿˜éœ€è¦å¯ä»¥**å¹²å‡€åœ°ç»„ç»‡å¯é‡ç”¨ä»£ç çš„èƒ½åŠ›**ã€‚

å·§å¦™çš„æ˜¯ï¼ŒåŸºäºå‡½æ•°çš„**Composition API**ï¼Œä¹Ÿå«åšç»„åˆAPIï¼ŒæŠŠè¿™äº›éœ€æ±‚å…¨éƒ½ç»™è§£å†³äº†ï¼Œå¥½å®¶ä¼™ï¼å¯¹äºComposition APIæˆ‘ä¼šåœ¨**ç¬¬ä¸‰éƒ¨åˆ†**ä¸­å†å»è¿›ä¸€æ­¥è°ˆè°ˆã€‚

___





# Howâ€”â€”å¦‚ä½•ä¼˜åŒ–ï¼Ÿ

å…³äºä¼˜åŒ–ï¼Œä¸»è¦ä»ä¸¤ä¸ªæ–¹é¢è°ˆè°ˆï¼š**å¦‚ä½•æ›´å¿«**å’Œ**å¦‚ä½•æ›´å°**ã€‚

## å¦‚ä½•æ›´å¿«ï¼Ÿ

>1. Object.defineProperty => **Proxy**
>2. çªç ´**Virtual DOM**ç“¶é¢ˆ
>3. æ›´å¤š**ç¼–è¯‘æ—¶ä¼˜åŒ–**
>		* **Slot** é»˜è®¤ç¼–è¯‘ä¸ºå‡½æ•°
>
>  	* æ¨¡æ¿é™æ€åˆ†æç”ŸæˆVNodeä¼˜åŒ–æ ‡è®°â€”â€”**patchFlag**

### Object.defineProperty => Proxy

è¿™éƒ¨åˆ†æˆ‘ä»¬åˆšåˆšå·²ç»è®²è¿‡äº†ï¼Œå®ƒä¸ä»…è®©å†…å­˜å ç”¨å˜å¾—æ›´å°ï¼Œè¿˜è®©ç»„ä»¶çš„åˆå§‹åŒ–å˜å¾—æ›´å¿«ï¼Œé‚£ä¹ˆæœ‰å¤šå¿«å‘¢ï¼Ÿ

æˆ‘æ¬è¿äº†**Vue3åŸå‹é˜¶æ®µ**å’Œ**Vue2.5**çš„ä¸€ä¸ªåˆå§‹åŒ–æ€§èƒ½æµ‹è¯•å¯¹æ¯”å›¾ï¼Œæµ‹è¯•çš„benchmarkæ˜¯**æ¸²æŸ“3000ä¸ªå¸¦çŠ¶æ€çš„ç»„ä»¶å®ä¾‹**ï¼š

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/86af0601fd2b4d60ab37d696d285b55b~tplv-k3u1fbpfcp-watermark.image)

å¯ä»¥çœ‹åˆ°ï¼Œå†…å­˜å ç”¨ä»…ä»…ä¸ºVue2çš„**ä¸€åŠ**ï¼Œåˆå§‹åŒ–çš„é€Ÿåº¦å¿«äº†å°†è¿‘**ä¸€å€**ã€‚

ä½†æ˜¯ï¼Œè¿˜ä¸å¤Ÿï¼

è¿™åªæ˜¯åˆå§‹åŒ–ï¼Œæˆ‘ä»¬çœ‹çœ‹ç»„ä»¶**æ›´æ–°æ—¶**çš„ä¼˜åŒ–ã€‚

### çªç ´Virtual DOMç“¶é¢ˆ

é¦–å…ˆï¼Œæˆ‘ä»¬çœ‹çœ‹ä¼ ç»Ÿçš„**Virtual DOM æ ‘**æ˜¯å¦‚ä½•æ›´æ–°çš„ï¼š

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/27f1adfc011e4ec789f979a73a8ca7dc~tplv-k3u1fbpfcp-watermark.image)
å½“æ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œä¸¤æ£µvdomçš„æ ‘ä¼šè¿›è¡Œ**diff**æ¯”è¾ƒï¼Œæ‰¾åˆ°éœ€è¦æ›´æ–°çš„èŠ‚ç‚¹å†**patch**ä¸ºå®é™…çš„**DOM**æ›´æ–°åˆ°æµè§ˆå™¨ä¸Šã€‚è¿™ä¸ªè¿‡ç¨‹åœ¨Vue2ä¸­å·²ç»ä¼˜åŒ–åˆ°äº†**ç»„ä»¶**çš„ç²’åº¦ï¼Œé€šè¿‡æ¸²æŸ“Watcherå»å‡†ç¡®æ‰¾åˆ°éœ€è¦æ›´æ–°çš„ç»„ä»¶ï¼Œå°†æ•´ä¸ªç»„ä»¶å†…çš„vdom treeè¿›è¡Œdiffã€‚è¿™ä¸ªç»„ä»¶ç²’åº¦çš„ä¼˜åŒ–**React**ä¹Ÿåšåˆ°äº†ï¼Œåªä¸è¿‡è¿™ä¸ªä¼˜åŒ–çš„æ“ä½œæ˜¯äº¤ç»™äº†ç”¨æˆ·ï¼Œæ¯”å¦‚åˆ©ç”¨**pureComponeng**ã€**shouldComponentUpdate**ç­‰ç­‰ã€‚

ä½†ç»„ä»¶çš„ç²’åº¦è¿˜æ˜¯ç›¸å¯¹æ¯”è¾ƒç²—çš„ï¼Œäºæ˜¯Vue3**é‡å†™**äº†Virtual Domï¼Œä»¥åˆ©ç”¨**æ¨¡æ¿çš„é™æ€åˆ†æ**ä¼˜åŠ¿å»å°†æ›´æ–°çš„ç²’åº¦è¿›ä¸€æ­¥ç¼©å°åˆ°**åŠ¨æ€å…ƒç´ **ç”šè‡³æ˜¯**åŠ¨æ€çš„å±æ€§**ã€‚

æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªæœ€ç®€å•çš„æƒ…å†µï¼š

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d2346bba9dbf400988aedb5b0eb12ccb~tplv-k3u1fbpfcp-watermark.image)

åœ¨ä¼ ç»Ÿçš„Virtual DOMä¸‹çš„diffè¿‡ç¨‹ï¼š
![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cec7d42d8ed04cceb645a76f5d0c150f~tplv-k3u1fbpfcp-watermark.image)

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸ªæ¨¡æ¿ä¸‹ï¼Œæ•´ä¸ªç»„ä»¶èŠ‚ç‚¹çš„ç»“æ„æ˜¯**å›ºå®šä¸å˜**çš„ï¼Œè€Œé‡Œé¢æœ‰å¤¹æ‚å¾ˆå¤šå®Œå…¨é™æ€çš„èŠ‚ç‚¹ï¼Œåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹æ˜¯åŠ¨æ€çš„ã€‚è€Œåœ¨ä¼ ç»Ÿçš„vdomä¸‹ï¼Œä»ç„¶å»éå†diffäº†è¿™äº›å®Œå…¨ä¸ä¼šå‘ç”Ÿå˜åŒ–çš„èŠ‚ç‚¹ã€‚è™½ç„¶Vue2å·²ç»å¯¹è¿™äº›å®Œå…¨é™æ€çš„èŠ‚ç‚¹è¿›è¡Œäº†ä¼˜åŒ–æ ‡è®°ä»¥ä¸€ç§fastPathçš„æ–¹å¼å»è·³è¿‡è¿™äº›é™æ€èŠ‚ç‚¹çš„diffï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€ä¸ªéå†é€’å½’çš„è¿‡ç¨‹ã€‚

é‚£ä¹ˆåœ¨Vue3æ–°çš„Virtual DOMä¸‹ï¼Œä¼šå¦‚ä½•è¿›è¡Œdiffå‘¢ï¼Ÿ

é€šè¿‡**compiler**å¯¹æ¨¡æ¿çš„é™æ€åˆ†æï¼Œåœ¨ä¼˜åŒ–æ¨¡å¼ä¸‹å°†é™æ€çš„å†…å®¹è¿›è¡Œ**hosting**ï¼Œä¹Ÿå°±æ˜¯æŠŠé™æ€èŠ‚ç‚¹æå‡åˆ°å¤–é¢å»ï¼Œå®é™…ç”Ÿæˆ**vnode**çš„å°±åªæœ‰åŠ¨æ€çš„å…ƒç´ `<p class="text">{{ msg }}</p>`ï¼Œå†åˆ†æè¿™ä¸ªå…ƒç´ å†…å¯èƒ½å‘ç”Ÿå˜åŒ–çš„ä¸œè¥¿ï¼Œå¯¹è¿™ä¸ªå…ƒç´ æ‰“ä¸Š**patchFlag**ï¼Œè¡¨ç¤ºè¿™ä¸ªå…ƒç´ å¯èƒ½å‘ç”Ÿå˜åŒ–çš„**ç±»å‹**æ˜¯æ–‡æœ¬å†…å®¹textContentè¿˜æ˜¯å±æ€§ç±»classç­‰ç­‰ã€‚

æˆ‘ä»¬çœ‹çœ‹æ¨¡æ¿ç¼–è¯‘ä¸º**render**å‡½æ•°åçš„ç»“æœï¼š
![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e1cbfb548b1a449b9ca2f0eb67de7900~tplv-k3u1fbpfcp-watermark.image)

å¯ä»¥çœ‹åˆ°ï¼Œ**å®Œå…¨é™æ€**çš„å…ƒç´ å·²ç»è¢«æå‡åˆ°renderå‡½æ•°ä¸Šé¢å»äº†ï¼Œå®é™…ä¼šåˆ›å»º**vnode**çš„å°±åªæœ‰ä¸€ä¸ªå«æœ‰åŠ¨æ€æ–‡æœ¬å†…å®¹çš„på…ƒç´ ã€‚

æ‰€ä»¥åœ¨æ–°çš„Virtual DOMä¸‹ï¼Œè¿™ä¸ªç»„ä»¶çš„diffè¿‡ç¨‹å°±å˜æˆäº†ï¼š

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/164b6f0f9ad3426c9a9e0bde9a635963~tplv-k3u1fbpfcp-watermark.image)

è‚‰çœ¼å¯è§çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªæ•°é‡çº§çš„ä¼˜åŒ–ã€‚

é‚£ä¹ˆåˆšåˆšè¯´äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªç»„ä»¶èŠ‚ç‚¹ç»“æ„å®Œå…¨å›ºå®šçš„æƒ…å†µï¼Œé‚£ä¹ˆä¹Ÿå°±æœ‰å¦ä¸€ç§æƒ…å†µï¼š**åŠ¨æ€èŠ‚ç‚¹**ã€‚

è€Œåœ¨Vueçš„æ¨¡æ¿ä¸­ï¼Œå‡ºç°åŠ¨æ€èŠ‚ç‚¹çš„æƒ…å†µå°±åªæœ‰**ä¸¤ç§**ï¼š

1. **v-if**
2. **v-for**

#### å…ˆçœ‹**v-if**ï¼š

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4bc43ca23eb140c290487eabb6e2da11~tplv-k3u1fbpfcp-watermark.image)

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨v-ifå†…éƒ¨ï¼ŒèŠ‚ç‚¹ç»“æ„åˆæ˜¯**å®Œå…¨å›ºå®š**çš„ï¼Œå¹¶ä¸”åªæœ‰`{{ msg }}`æ˜¯åŠ¨æ€èŠ‚ç‚¹ã€‚æ‰€ä»¥å¦‚æœæŠŠv-ifåˆ’åˆ†ä¸ºä¸€ä¸ª**åŒºå—Block**çš„è¯ï¼Œåˆå˜æˆäº†æˆ‘ä»¬ä¸Šä¸€ä¸ªçœ‹çš„é‚£ç§æƒ…å†µã€‚å› æ­¤ï¼Œåªè¦å…ˆå°†æ•´ä¸ªæ¨¡æ¿çœ‹ä½œä¸€ä¸ªBlockï¼Œç„¶åä»¥åŠ¨æ€æŒ‡ä»¤è¿›è¡Œåˆ’åˆ†ä¸€ä¸ªä¸ªåµŒå¥—çš„Blockï¼Œæ¯ä¸ªBlockå°±éƒ½å˜æˆæœ€ç®€å•çš„é‚£ç§æƒ…å†µäº†ï¼š


![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0b6f29c898884e26abaffe5c647f2200~tplv-k3u1fbpfcp-watermark.image)

å¹¶ä¸”æ¯ä¸ªBlocké‡Œé¢çš„**åŠ¨æ€å…ƒç´ **åªéœ€è¦ä»¥ä¸€ä¸ªç®€å•çš„æ‰“å¹³çš„**æ•°ç»„**å»è®°å½•è·Ÿè¸ªå³å¯ã€‚æ‰€ä»¥diffçš„è¿‡ç¨‹å°±åªæ˜¯éå†é€’å½’å»æ‰¾é‚£äº›å­˜åœ¨åŠ¨æ€èŠ‚ç‚¹çš„Blockï¼Œæ ¹æ®è¿™äº›åŠ¨æ€Blockä¸­çš„ä¸€ä¸ªæ•°ç»„å°±å¯ä»¥å®Œæˆdiffçš„è¿‡ç¨‹ã€‚

æ‰€ä»¥åˆšåˆšè¿™ä¸ªv-ifçš„ä¾‹å­çš„æ–°diffè¿‡ç¨‹å°±æ˜¯ï¼š
![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d2e608e109934957a5154fd8f26016be~tplv-k3u1fbpfcp-watermark.image)



#### v-forä¹Ÿæ˜¯ç›¸åŒçš„åŸç†ï¼Œå°†v-foråˆ’åˆ†ä¸ºä¸€ä¸ªBlockï¼š

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a11db4244c3488897db645642f55042~tplv-k3u1fbpfcp-watermark.image)

åªæœ‰ v-for æ˜¯**åŠ¨æ€èŠ‚ç‚¹** ï¼Œæ¯ä¸ª v-for å¾ªç¯å†…éƒ¨ï¼šåªæœ‰ {{ item.message }} æ˜¯åŠ¨æ€èŠ‚ç‚¹ã€‚å®ƒçš„diffè¿‡ç¨‹ï¼š

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/28ca3020092d4aa784219fbdfce5a67f~tplv-k3u1fbpfcp-watermark.image)




#### æ€»ç»“ï¼š

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4bcf720f636a4ef5a219a754cc37f894~tplv-k3u1fbpfcp-watermark.image)
* å°†æ¨¡ç‰ˆåŸºäº**åŠ¨æ€èŠ‚ç‚¹æŒ‡ä»¤**åˆ‡å‰²ä¸ºåµŒå¥—çš„**åŒºå—**
* æ¯ä¸ªåŒºå—å†…éƒ¨çš„èŠ‚ç‚¹ç»“æ„æ˜¯**å›ºå®š**çš„
* æ¯ä¸ªåŒºå—åªéœ€è¦ä»¥ä¸€ä¸ª**å¹³é¢æ•°ç»„**è¿½è¸ªè‡ªèº«åŒ…å«çš„**åŠ¨æ€èŠ‚ç‚¹**



æ‰€ä»¥Virtual DOMçš„æ›´æ–°æ€§èƒ½ä»ä¸**æ¨¡æ¿æ•´ä½“å¤§å°**ç›¸å…³ï¼Œæå‡åˆ°äº†åªä¸**åŠ¨æ€å†…å®¹çš„æ•°é‡**ç›¸å…³ï¼š

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c05dc8201b43444cb51429bea51fa563~tplv-k3u1fbpfcp-watermark.image)

### æ›´å¤šç¼–è¯‘æ—¶ä¼˜åŒ–

* **Slot**é»˜è®¤ç¼–è¯‘ä¸º**å‡½æ•°**

  è¿™ä¸ªè®©ä½¿ç”¨æ’æ§½çš„çˆ¶å­ç»„ä»¶ä¹‹é—´çš„**æ›´æ–°å…³ç³»**ä¸å†å¼ºè€¦åˆ

* åˆ©ç”¨æ¨¡æ¿**é™æ€åˆ†æ**å¯¹vnodeç”Ÿæˆçš„ç±»å‹æ ‡è®°â€”â€”**patchFlag**

  è¿™ä¸€ç‚¹æˆ‘ä»¬åˆšåˆšä¹Ÿè®²åˆ°äº†ï¼Œå¯¹äº**pacthFlag**çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å»æºç ä¸­çœ‹çœ‹ï¼ˆä¸ºäº†æ–¹ä¾¿æˆªå›¾ï¼Œæˆ‘åˆ äº†éƒ¨åˆ†çš„æ³¨é‡Šï¼Œä»¥åŠæ ‡æ³¨äº†å‰å‡ ä¸ªçš„ç±»å‹çš„äºŒè¿›åˆ¶å€¼å‡ºæ¥ï¼‰ï¼š
![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b24edb6892af425f9dea51148873239b~tplv-k3u1fbpfcp-watermark.image)

**<<** å°±æ˜¯å·¦ç§»æ“ä½œç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€å…±æœ‰**åä¸ª**åŠ¨æ€çš„**ç±»å‹**ï¼Œæ¯ä¸ªç±»å‹çš„æ•°å€¼éƒ½æ˜¯åœ¨1çš„åŸºç¡€ä¸Šç§»åŠ¨ä¸åŒä½æ•°å¾—åˆ°çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªåä¸€ä½çš„**äºŒè¿›åˆ¶æ•°**å°±æè¿°äº†vnodeçš„**åŠ¨æ€ç±»å‹**ã€‚å¹¶ä¸”å°¤å¤§éå¸¸å‹å¥½åœ°å‘Šè¯‰æˆ‘ä»¬äº†è¿™ä¸ªæ€ä¹ˆç”¨ï¼š
![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/769ac4b9488b49b5a70e406c797fb252~tplv-k3u1fbpfcp-watermark.image)

vnodeçš„patchFlagé€šè¿‡ **|** æ“ä½œç¬¦å»ç»„åˆèµ·æ¥ï¼Œvnodeçš„patchFlagå’ŒæŸä¸ªç‰¹å®šç±»å‹æ‰€ä»£è¡¨çš„patchFlagå°±ç”¨ **&** æ“ä½œç¬¦è®¡ç®—ä¸€ä¸‹ï¼Œå¦‚æœå¾—åˆ°çš„ç»“æœä¸º**0**ï¼Œåˆ™è¯´æ˜è¿™ä¸ªvnodeçš„è¿™ä¸ªç±»å‹çš„å±æ€§æ˜¯**ä¸ä¼šå˜**çš„ï¼Œ**ä¸ä¸º0åˆ™ç›¸å**ã€‚è¿˜å¼•å¯¼äº†ä½ å»`renderer.ts`ä¸‹çœ‹çœ‹æ€ä¹ˆä½¿ç”¨çš„ï¼Œä¸è¿‡ä»–çš„è·¯å¾„ä¼¼ä¹æœ‰ç‚¹é—®é¢˜....æˆ‘çœ‹çš„æ˜¯`packages/runtime-core/src/renderer.ts`ã€‚ä½†æ›´æ·±å…¥çš„å†…å®¹å°±ä¸åœ¨è¿™é‡Œå±•å¼€äº†ï¼Œæ„Ÿå…´è¶£çš„è¯ä»¥åå¯ä»¥å†™ä¸€ç¯‡ä¸“é—¨è®²è®²è¿™ä¸ªå§ã€‚

çœ‹åˆ°å°¤å¤§è¿™ä¸ªæ“ä½œçš„æ—¶å€™çœŸçš„æ˜¯æƒŠäº†ï¼Œå†™ä»£ç è¿˜èƒ½è¿™ä¹ˆç©çš„å•Šï¼Ÿ

ç„¶åçµå…‰ä¸€é—ªï¼Œæˆ‘å¯»æ€å†™**ç”¨æˆ·é‰´æƒ**å¥½åƒä¹Ÿå¯ä»¥è¿™ä¹ˆç©å§ã€‚

Soï¼Œtry it nowï¼š
![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/466810954cab48d3b8c7b4a8f38b6fc0~tplv-k3u1fbpfcp-watermark.image)


è¿˜è›®æœ‰æ„æ€çš„~



è¨€å½’æ­£ä¼ ï¼Œç»è¿‡äº†è¿™ä¹ˆå±‚å±‚ä¼˜åŒ–ï¼ŒVue3ç©¶ç«Ÿ**æœ‰å¤šå¿«**ï¼Ÿ

æˆ‘å»vue3.0 releaseæ—¶ç»™å‡ºçš„æ•°æ®[https://docs.google.com/spreadsheets/d/1VJFx-kQ4KjJmnpDXIEaig-cVAAJtpIGLZNbv3Lr4CR0/edit#gid=0](https://docs.google.com/spreadsheets/d/1VJFx-kQ4KjJmnpDXIEaig-cVAAJtpIGLZNbv3Lr4CR0/edit#gid=0) ä¸­æ¬è¿äº†è¿‡æ¥ï¼š
![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/92aee9d99d4945b6bc05a9acfba9afb4~tplv-k3u1fbpfcp-watermark.image)

å¯ä»¥çœ‹åˆ°ï¼Œä¸Vue2ç›¸æ¯”ï¼ŒVue 3åœ¨bundleåŒ…å¤§å°**å‡å°‘41%**ã€åˆå§‹æ¸²æŸ“**å¿«äº†55%**ã€æ›´æ–°**å¿«äº†133%** å’Œå†…å­˜ä½¿ç”¨ **å‡å°‘54%** ã€‚

___

## å¦‚ä½•æ›´å°ï¼Ÿ

æœ€ä¸»è¦çš„å°±æ˜¯å……åˆ†åˆ©ç”¨äº†**Tree-shaking**çš„ç‰¹æ€§ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯Tree-shakingå‘¢? ä¸­æ–‡ç¿»è¯‘è¿‡æ¥å°±æ˜¯æŠ–æ ‘ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„**å·¥ä½œåŸç†**ï¼š

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/97c5313ab49f4f33861268407a78f3eb~tplv-k3u1fbpfcp-watermark.image)

å°ç©ç¬‘...

**MDN**ä¸Šå¯¹Tree shakingçš„æè¿°ï¼š
![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0a0c0e2bbde94d68a7d0768267186cbb~tplv-k3u1fbpfcp-watermark.image)

ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¸ºäº†æ›´å¥½åœ°ä½“ä¼šåˆ°å®ƒçš„ä½œç”¨ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹ä¸¤ç§**export**çš„å†™æ³•ï¼š

ç¬¬ä¸€ç§ï¼š

```javascript
const msgA = 'hhhh'

const msgB = 777

const funcA = () => {
    console.log('AAA')
}

const funcB = () => {
    console.log('BBB')
}

export default{
    msgA,
    msgB,
    funcA,
    funcB
};
```

ç¬¬äºŒç§ï¼š

```javascript
export const msgA = 'hhhh'

export const msgB = 777

export const funcA = () => {
    console.log('AAA')
}

export const funcB = () => {
    console.log('BBB')
}
```

ç„¶åæˆ‘åœ¨`main.ts`ä¸­åˆ†åˆ«å¼•å…¥å¹¶ä½¿ç”¨è¿™ä¸¤ä¸ªæ¨¡å—ï¼š

ç¬¬ä¸€ç§ï¼š

```javascript
import TreeShaking1 from "@/benchmarks/TreeShaking1"

console.log(TreeShaking1.msgA)
TreeShaking1.funcA()
```

ç¬¬äºŒç§ï¼š

```javascript
import {funcA,msgA} from "@/benchmarks/TreeShaking2"

console.log(msgA)
// funcA()
```

buildä»¥åç”Ÿæˆçš„`app.js bundle`ï¼š

ç¬¬ä¸€ç§ï¼š
![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8d52aa2300db47c98c8819fd11308367~tplv-k3u1fbpfcp-watermark.image)

ç¬¬äºŒç§ï¼š

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3e767bd695224d3687d7e2f2ebf19f3a~tplv-k3u1fbpfcp-watermark.image)


æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œtree shakingä»¥åï¼Œè¿›å…¥bundleçš„åªæœ‰è¢«å¼•å…¥å¹¶ä¸”**çœŸæ­£ä¼šè¢«ä½¿ç”¨**çš„ä»£ç å—ã€‚åœ¨Vue3ä¸­è®¸å¤šæ¸è¿›å¼çš„ç‰¹æ€§éƒ½ä½¿ç”¨äº†ç¬¬äºŒç§çš„å†™æ³•æ¥è¿›è¡Œé‡å†™ï¼Œè€Œä¸”**æ¨¡æ¿**æœ¬èº«åˆæ˜¯Tree shakingå‹å¥½çš„ã€‚

ä½†ä¸æ˜¯æ‰€æœ‰ä¸œè¥¿éƒ½å¯ä»¥è¢«æŠ–æ‰ï¼Œæœ‰éƒ¨åˆ†ä»£ç æ˜¯å¯¹ä»»ä½•ç±»å‹çš„åº”ç”¨ç¨‹åºéƒ½ä¸å¯æˆ–ç¼ºçš„ï¼Œæˆ‘ä»¬æŠŠè¿™äº›ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ç§°ä¹‹ä¸º**åŸºçº¿å¤§å°**ï¼Œæ‰€ä»¥Vue3å°½ç®¡å¢åŠ äº†å¾ˆå¤šçš„æ–°ç‰¹æ€§ï¼Œä½†æ˜¯è¢«å‹ç¼©åçš„åŸºçº¿å¤§å°åªæœ‰**10KB**å·¦å³ï¼Œç”šè‡³ä¸åˆ°Vue2çš„**ä¸€åŠ**ã€‚

æˆ‘æŠŠåˆšåˆšçš„ä¸¤ä¸ªdemoæ‰€åœ¨çš„é¡¹ç›®**build**ä»¥åï¼š

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c0c4413355114b9cb36e5b6f56ac1023~tplv-k3u1fbpfcp-watermark.image)


å¯ä»¥çœ‹åˆ°è¿™ä¸ª**app.js**çš„bundleåªæœ‰`9.68kb`ï¼Œè¿™è¿˜æ˜¯åŒ…æ‹¬äº†`router`åœ¨å†…çš„ï¼Œè€Œä»¥å¾€Vue2æ„å»ºå‡ºæ¥çš„æ™®ééƒ½åœ¨**20+kb**ä»¥ä¸Šã€‚





# Whatâ€”â€”æ–°ä¸œè¥¿ï¼Ÿ

ä¸€èµ·çœ‹çœ‹Vue3ç»™æˆ‘ä»¬å¸¦æ¥äº†å“ªäº›å€¼å¾—å…³æ³¨çš„æ–°ä¸œè¥¿ã€‚

## Composition API

é¦–å…ˆå½“ç„¶æ˜¯ä¸‡ä¼—ç©ç›®çš„Composition APIã€‚

ä¸ºæ­¤ï¼Œæˆ‘æ¬è¿äº†ç„¶å”çš„ä¸€å¤œåŠ¨ç”»~

æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹åœ¨Vue2ä¸­**OptionsAPI**æ˜¯æ€ä¹ˆå†™çš„ï¼š
![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/165a0e8847954d6581fa913a02491d61~tplv-k3u1fbpfcp-watermark.image)

éšç€äº§å“è¿­ä»£ï¼Œäº§å“ç»ç†ä¸æ–­æå‡ºäº†æ–°çš„éœ€æ±‚ï¼š
![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6ea680e1cbce461e8ba46cdbc73dded0~tplv-k3u1fbpfcp-watermark.image)

ç”±äºç›¸å…³ä¸šåŠ¡çš„ä»£ç éœ€è¦éµå¾ªoptionçš„é…ç½®å†™åˆ°**ç‰¹å®šçš„åŒºåŸŸ**ï¼Œå¯¼è‡´åç»­**ç»´æŠ¤**éå¸¸çš„å¤æ‚ï¼Œä»£ç å¯**å¤ç”¨æ€§**ä¹Ÿä¸é«˜ã€‚æœ€éš¾å—çš„æ˜¯æ•²ä»£ç çš„æ—¶å€™ä¸å¾—ä¸ä¸Šä¸‹**åå¤æ¨ªè·³**ï¼Œæ™ƒå¾—çœ¼ç...

ç”¨äº†**CompositionAPI**ä¼šå˜æˆä»€ä¹ˆæ ·å‘¢ï¼Ÿ
![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7f0b5f13172742c4a9a4136c2194176f~tplv-k3u1fbpfcp-watermark.image)

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒåŠŸèƒ½ç›¸å…³çš„ä»£ç éƒ½èšåˆèµ·æ¥äº†ï¼Œä»£ç å˜å¾—**äº•ç„¶æœ‰åº**ï¼Œä¸å†é¢‘ç¹åœ°ä¸Šä¸‹åå¤æ¨ªè·³ã€‚ä½†è¿˜å·®ç‚¹æ„æ€ï¼Œäº‹å®ä¸Šï¼Œæˆ‘ä»¬å¾ˆå¤šé€»è¾‘ç›¸å…³çš„æ“ä½œæ˜¯ä¸éœ€è¦ä½“ç°å‡ºæ¥çš„ï¼ŒçœŸæ­£éœ€è¦ä½¿ç”¨åˆ°çš„å¯èƒ½åªæ˜¯å…¶ä¸­çš„ä¸€äº›å˜é‡ã€æ–¹æ³•ï¼Œè€ŒComposition APIå¸¦æ¥çš„å‡ºè‰²**ä»£ç ç»„ç»‡å’Œå¤ç”¨**èƒ½åŠ›ï¼Œè®©ä½ å¯ä»¥æŠŠåŠŸèƒ½ç›¸å…³çš„ä»£ç æŠ½ç¦»å‡ºå»æˆä¸ºä¸€ä¸ªå¯å¤ç”¨çš„å‡½æ•°JSã€TSæ–‡ä»¶ï¼Œåœ¨.vueæ–‡ä»¶ä¸­é€šè¿‡å‡½æ•°çš„è°ƒç”¨æŠŠåˆšåˆšè¿™äº›å‡½æ•°çš„è¿”å›å€¼ç»„åˆèµ·æ¥ï¼Œæœ€åè¿”å›æ¨¡æ¿çœŸæ­£éœ€è¦ä½¿ç”¨åˆ°çš„ä¸œè¥¿ï¼š
![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fb018fe4950f4ca7abfe94986a78bb2a~tplv-k3u1fbpfcp-watermark.image)

å·´é€‚å¾—å¾ˆ~

Composition APIä¸ºä½•è¿™ä¹ˆå¥½ç”¨ï¼Œå¾—ç›Šäºå®ƒçš„ä¸¤ä¸ªæ ¸å¿ƒç»„æˆï¼š

* Reactivityâ€”â€”**å“åº”å¼ç³»ç»Ÿ**
* **ç”Ÿå‘½å‘¨æœŸé’©å­**

å“åº”å¼ç³»ç»Ÿæš´éœ²äº†æ›´å¤šåº•å±‚çš„APIå‡ºæ¥ï¼Œä»è€Œè®©æˆ‘ä»¬å¾ˆè½»æ¾åœ°å»åˆ›å»ºä½¿ç”¨å“åº”å¼å˜é‡ã€‚ç„¶åç»“åˆæš´éœ²å‡ºæ¥çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼ŒåŸºæœ¬å°±å¯ä»¥å®Œæˆæ•´ä¸ªç»„ä»¶çš„é€»è¾‘è¿ä½œã€‚å½“ç„¶è¿˜å¯ä»¥ç»“åˆæ›´å¤šçš„apiå®Œæˆæ›´å¤æ‚çš„å·¥ä½œï¼Œç¤¾åŒºä¹Ÿæœ‰å¾ˆå¤šå…³äºCompositionAPIçš„ä½¿ç”¨æŠ€å·§å’Œæ–¹æ³•ï¼Œè¿™ä¸€å—å°±ä¸å»ç»†åŒ–äº†ï¼Œç‚¹åˆ°ä¸ºæ­¢ã€‚



### ä¼˜åŠ¿

å¯¹æ¯”**Class API**ï¼š

* æ›´å¥½çš„ **TypeScript** ç±»å‹æ¨å¯¼æ”¯æŒ

  functionå¯¹äºç±»å‹ç³»ç»Ÿæ˜¯éå¸¸å‹å¥½çš„ï¼Œå°¤å…¶æ˜¯å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ã€‚

* ä»£ç æ›´å®¹æ˜“è¢«**å‹ç¼©**

  ä»£ç åœ¨å‹ç¼©çš„æ—¶å€™ï¼Œæ¯”å¦‚å¯¹è±¡çš„keyæ˜¯ä¸ä¼šè¿›è¡Œå‹ç¼©çš„ï¼Œè¿™ä¸€ç‚¹å¯ä»¥ä»æˆ‘ä»¬åˆšåˆšå¯¹äºThree shaking demoæ„å»ºå‡ºæ¥çš„åŒ…å°±å¯ä»¥çœ‹å¾—å‡ºæ¥ï¼š

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/17e7687784084abd8cd49517eca2e199~tplv-k3u1fbpfcp-watermark.image)

  è€Œcomposition APIå£°æ˜çš„ä¸€äº›å“åº”å¼å˜é‡ï¼Œå°±å¯ä»¥å¾ˆå®‰å…¨åœ°å¯¹å˜é‡åè¿›è¡Œå‹ç¼©ã€‚

* Tree-shaking å‹å¥½

  CompositionAPIè¿™ç§å¼•ç”¨è°ƒç”¨çš„æ–¹å¼ï¼Œæ„å»ºå·¥å…·å¯ä»¥å¾ˆè½»æ¾åœ°åˆ©ç”¨**Tree shaking**å»æ¶ˆé™¤æˆ‘ä»¬å®é™…æœªä½¿ç”¨åˆ° â€œæ­»ä»£ç â€œ

* æ›´çµæ´»çš„**é€»è¾‘å¤ç”¨**èƒ½åŠ›

  åœ¨Vue2ä¸­ï¼Œæˆ‘ä»¬ä¸€ç›´ç¼ºå°‘ä¸€ç§å¾ˆå¹²å‡€æ–¹ä¾¿çš„é€»è¾‘å¤ç”¨æ–¹æ³•ã€‚

  ä»¥å¾€æˆ‘ä»¬è¦æƒ³åšåˆ°é€»è¾‘å¤ç”¨ï¼Œä¸»è¦æœ‰ä¸‰ç§æ–¹å¼ï¼š

  1. æ··å…¥â€”â€”**Mixins**
  2. é«˜é˜¶ç»„ä»¶â€”â€”**HOC**
  3. **ä½œç”¨åŸŸæ’æ§½**

ä¸ºäº†æ›´å¥½åœ°ä½“ä¼šè¿™ä¸‰ç§æ–¹æ³•çš„æ¶å¿ƒä¹‹å¤„ï¼Œæˆ‘ç”¨ä¸€ä¸ªç®€å•çš„**demo**å»åˆ†åˆ«æ¼”ç¤ºè¿™ä¸‰ç§æ–¹æ³•ã€‚

æ¡ˆä¾‹ï¼š**é¼ æ ‡ä½ç½®ä¾¦å¬**:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/756a6f85f4db4835b76609dddb3ade80~tplv-k3u1fbpfcp-watermark.image)

å…ˆçœ‹çœ‹Mixinsçš„æ–¹å¼ï¼š

#### Mixins

MouseMixin.js:

```javascript
import {throttle} from "lodash"

let throttleUpdate;

export default {
    data:()=>({
        x:0,
        y:0
    }),
    
    methods:{
        update(e){
            console.log('still on listening')
            this.x = e.pageX
            this.y = e.pageY
        }
    },
    
    beforeMount() {
        throttleUpdate = throttle(this.update,200).bind(this)
    },
    mounted() {
        window.addEventListener('mousemove',throttleUpdate)
    },
    unmounted() {
        window.removeEventListener('mousemove',throttleUpdate)
    }
}

```

ä½¿ç”¨ï¼š

```vue
<template>
  <header>
    <h1>è·å–é¼ æ ‡ä½ç½®â€”â€”Mixins</h1>
  </header>

  <main>
    <span>(</span>
    <transition name="text" mode="out-in">
      <div :key="x" class="position">{{ x }}</div>
    </transition>
    <span>,</span>
    <transition name="text" mode="out-in">
      <div :key="y" class="position">{{ y }}</div>
    </transition>
    <span>)</span>
  </main>
</template>


<script>
import {defineComponent} from "vue"

import MouseMixin from "@/components/Mouse/MouseMixin.js";

export default defineComponent({
  mixins: [MouseMixin],
  components: {}
})
</script>
```

å½“å¤§é‡ä½¿ç”¨mixinæ—¶ï¼š

* âŒ **å‘½åç©ºé—´å†²çª**
* âŒ **æ¨¡ç‰ˆæ•°æ®æ¥æºä¸æ¸…æ™°**

#### HOCâ€”â€”é«˜é˜¶ç»„ä»¶

HOCåœ¨**React**ä½¿ç”¨å¾—æ¯”è¾ƒå¤šï¼Œå®ƒæ˜¯ç”¨æ¥æ›¿ä»£mixinçš„æ–¹æ¡ˆã€‚äº‹å®ä¸ŠVueä¹Ÿå¯ä»¥å†™HOCã€‚

å…¶åŸç†å°±æ˜¯åœ¨ç»„ä»¶å¤–é¢å†åŒ…ä¸€å±‚çˆ¶ç»„ä»¶ï¼Œå¤ç”¨çš„é€»è¾‘åœ¨çˆ¶ç»„ä»¶ä¸­ï¼Œé€šè¿‡**props**ä¼ å…¥åˆ°å­ç»„ä»¶ä¸­ã€‚

çœ‹çœ‹è¿™ä¸ªå¸¦æœ‰å¯å¤ç”¨é€»è¾‘çš„**MouseHOC**æ€ä¹ˆå†™ï¼š

```javascript
import Mouse2 from "@/views/Mouse/Mouse2.vue";

import { defineComponent } from "vue";
import { throttle } from "lodash";

let throttleUpdate;

export default defineComponent({
  render() {
    return (
        <Mouse2 x={this.x} y={this.y}/>
    );
  },
  data: () => ({
    x: 0,
    y: 0,
  }),
  methods: {
    update(e) {
      this.x = e.pageX;
      this.y = e.pageY;
    },
  },
  beforeMount() {
    throttleUpdate = throttle(this.update, 200).bind(this);
  },
  mounted() {
    window.addEventListener("mousemove", throttleUpdate);
  },
  unmounted() {
    window.removeEventListener("mousemove", throttleUpdate);
  },
});

```

HOCå†…éƒ¨çš„å­ç»„ä»¶â€”â€”Mouse2.vueï¼š

```vue
<template>
  <header>
    <h1>è·å–é¼ æ ‡ä½ç½®â€”â€”HOC</h1>
  </header>

  <main>
    <span>(</span>
    <transition name="text" mode="out-in">
      <div :key="x" class="position">{{ x }}</div>
    </transition>
    <span>,</span>
    <transition name="text" mode="out-in">
      <div :key="y" class="position">{{ y }}</div>
    </transition>
    <span>)</span>
  </main>
</template>

<script lang="ts">
import {defineComponent} from "vue"
export default defineComponent({
  props:['x','y']
})
</script>
```



åŒæ ·ï¼Œåœ¨å¤§é‡ä½¿ç”¨HOCçš„æ—¶å€™çš„é—®é¢˜ï¼š

* âŒ **props å‘½åç©ºé—´å†²çª**
* âŒ **props æ¥æºä¸æ¸…æ™°**
* âŒ **é¢å¤–çš„ç»„ä»¶å®ä¾‹æ€§èƒ½æ¶ˆè€—**



#### ä½œç”¨åŸŸæ’æ§½

åŸç†å°±æ˜¯é€šè¿‡ä¸€ä¸ª**æ— éœ€æ¸²æŸ“**çš„ç»„ä»¶â€”â€”**renderless component**ï¼Œé€šè¿‡**ä½œç”¨åŸŸæ’æ§½**çš„æ–¹å¼æŠŠå¯å¤ç”¨é€»è¾‘è¾“å‡ºçš„å†…å®¹æ”¾åˆ°`slot-scope`ä¸­ã€‚

çœ‹çœ‹è¿™ä¸ªæ— æ¸²æŸ“ç»„ä»¶æ€ä¹ˆå†™ï¼š

```vue
<template>
  <slot :x="x" :y="y"></slot>
</template>

<script>
import {throttle} from "lodash";

let throttleUpdate;

  export default {
    data:()=>({
      x:0,
      y:0
    }),
    methods:{
      update(e){
        console.log('still on listening')
        this.x = e.pageX
        this.y = e.pageY
      }
    },
    beforeMount() {
      throttleUpdate = throttle(this.update,200).bind(this)
    },
    mounted() {
      window.addEventListener('mousemove',throttleUpdate)
    },
    unmounted() {
      window.removeEventListener('mousemove',throttleUpdate)
    }
  }
</script>
```

åœ¨é¡µé¢ç»„ä»¶`Mouse3.vue`ä¸­ä½¿ç”¨:

```vue
<template>
  <header>
    <h1>è·å–é¼ æ ‡ä½ç½®â€”â€”slot</h1>
  </header>
  <main>
    <span>(</span>

    <MouseSlot v-slot="{x,y}">
      <transition name="text" mode="out-in">
        <div :key="x" class="position">{{ x }}</div>
      </transition>
      <span>,</span>
      <transition name="text" mode="out-in">
        <div :key="y" class="position">{{ y }}</div>
      </transition>
    </MouseSlot>

    <span>)</span>
  </main>
</template>

<script lang="ts">
import {defineComponent} from "vue"
import MouseSlot from "@/components/Mouse/MouseSlot.vue"

export default defineComponent({
  components: {
    MouseSlot
  }
})
</script>
```

å½“å¤§é‡ä½¿ç”¨æ—¶ï¼š

* âœ” **æ²¡æœ‰å‘½åç©ºé—´å†²çª**
* âœ” **æ•°æ®æ¥æºæ¸…æ™°**
* âŒ **é¢å¤–çš„ç»„ä»¶å®ä¾‹æ€§èƒ½æ¶ˆè€—**

è™½ç„¶æ— æ¸²æŸ“ç»„ä»¶å·²ç»æ˜¯ä¸€ç§æ¯”è¾ƒå¥½çš„æ–¹å¼äº†ï¼Œä½†å†™èµ·æ¥ä»ç„¶è›®æ¶å¿ƒçš„ã€‚

æ‰€ä»¥ï¼Œåœ¨Composition APIä¸­ï¼Œæ€ä¹ˆåšåˆ°é€»è¾‘å¤ç”¨å‘¢ï¼Ÿ

#### Composition API

æš´éœ²ä¸€ä¸ªå¯å¤ç”¨å‡½æ•°çš„æ–‡ä»¶ï¼š`useMousePosition.ts`ï¼Œè¿™ä¸ªå‘½ååªæ˜¯è®©ä»–çœ‹èµ·æ¥æ›´åƒreact hooksä¸€äº›ï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºæ¥è¿™ä¸ªæ–‡ä»¶è¿™ä¸ªå‡½æ•°æ˜¯å¹²ä»€ä¹ˆçš„ï¼Œå®é™…ä¸Šä½ å®šä¹‰ä¸ºå…¶ä»–ä¹Ÿä¸æ˜¯ä¸å¯ä»¥ã€‚

```typescript
import {ref, onMounted, onUnmounted} from "vue"
import {throttle} from "lodash"

export default function useMousePosition() {

    const x = ref(0)
    const y = ref(0)

    const update = throttle((e: MouseEvent) => {
        x.value = e.pageX
        y.value = e.pageY
    }, 200)

    onMounted(() => {
        window.addEventListener('mousemove', update)
    })
    onUnmounted(() => {
        window.removeEventListener('mousemove', update)
    })

    return { x, y }
}
```

é¡µé¢ç»„ä»¶`Mouse4.vue`ä¸­ä½¿ç”¨ï¼š

```vue
<template>
  <header>
    <h1>è·å–é¼ æ ‡ä½ç½®â€”â€”Composition API</h1>
  </header>

  <main>
    <span>(</span>
    <transition name="text" mode="out-in">
      <div :key="x" class="position">{{ x }}</div>
    </transition>
    <span>,</span>
    <transition name="text" mode="out-in">
      <div :key="y" class="position">{{ y }}</div>
    </transition>
    <span>)</span>
  </main>
</template>


<script lang="ts">
import {defineComponent} from "vue"
import useMousePosition from "@/components/Mouse/useMousePosition";

export default defineComponent({
  setup() {
    const { x, y } = useMousePosition()
    return { x, y }
  }
})
</script>
```

å³ä½¿åœ¨å¤§é‡ä½¿ç”¨æ—¶ï¼š

* âœ” **æ²¡æœ‰å‘½åç©ºé—´å†²çª**
* âœ” **æ•°æ®æ¥æºæ¸…æ™°**
* âœ” **æ²¡æœ‰é¢å¤–çš„ç»„ä»¶å®ä¾‹æ€§èƒ½æ¶ˆè€—**

**å¹²å‡€**ã€**æ¸…æ™°**ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ç§å‡½æ•°å¼ä¹Ÿç»™äºˆäº†ä¼˜ç§€çš„**ä»£ç ç»„ç»‡**èƒ½åŠ›ã€‚

ä¸ºäº†æ¼”ç¤ºè¿™ä¸€ç‚¹ï¼Œæˆ‘æŠŠVue2ç¤ºä¾‹ä¸­çš„`todoMVC`é¡¹ç›®æ¬ä¸‹æ¥ç”¨CompositionAPI**é‡æ„**äº†ä¸€ä¸‹ã€‚

`todoMVC`å°±æ˜¯ä¸€ä¸ªå¾…åŠäº‹é¡¹çš„å°åº”ç”¨ï¼ŒåŠŸèƒ½æœ‰ï¼š

1. æœ¬åœ°ç¼“å­˜ï¼Œå¹¶åŠ¨æ€å­˜å‚¨åˆ°LocalStorageä¸­
2. æ–°å¢ä»£åŠäº‹é¡¹
3. ç‚¹å‡»å®Œæˆä»£åŠäº‹é¡¹ï¼Œä¸€é”®å…¨éƒ¨å®Œæˆ/æœªå®Œæˆ
4. åˆ é™¤ä»£åŠäº‹é¡¹
5. æ¸…ç©ºå·²å®Œæˆçš„ä»£åŠäº‹é¡¹
6. æ ¹æ®å®ŒæˆçŠ¶æ€ç­›é€‰ä»£åŠäº‹é¡¹åˆ—è¡¨

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4dbf3df9d49450c91dfc33a8931b6a9~tplv-k3u1fbpfcp-watermark.image)

ï¼ˆåˆé’»çš„æœ‹å‹å¯èƒ½å‘ç°æˆ‘æŠŠç¼–è¾‘åŠŸèƒ½é˜‰å‰²æ‰äº†ï¼Œè¿™é‡Œç¡®å®å·äº†ä¸ªæ‡’ï¼Œå½“æ—¶å†™å¾—æ¯”è¾ƒç€æ€¥ï¼Œåˆå› ä¸ºä¸€äº›å…¼å®¹æ€§çš„åŸå› ï¼Œç¼–è¾‘çŠ¶æ€ç‚¹ä¸å‡ºæ¥ï¼Œä¸€æ°”ä¹‹ä¸‹æŠŠç¼–è¾‘é˜‰äº†....å…¶å®æœ‰æ²¡æœ‰ä¹Ÿä¸å¤ªå½±å“æˆ‘æƒ³è¦è¯´æ˜çš„ä¸œè¥¿ï¼‰

æ¥ç ï¼Œæ•´ä¸ªä»£åŠäº‹é¡¹ç»„ä»¶ï¼š`TodoMVC.vue`

```typescript
import {defineComponent} from "vue"
import useTodoState from "@/views/TodoMVC/useTodoState";
import useFilterTodos from "@/views/TodoMVC/useFilterTodos";
import useHashChange from "@/views/TodoMVC/useHashChange";

export default defineComponent({
  setup() {

    /*å“åº”å¼å˜é‡ã€æ–°å¢å’Œåˆ é™¤ä»£åŠäº‹é¡¹çš„æ–¹æ³•*/
    const {
      todos,
      newTodo,
      visibility,
      addTodo,
      removeTodo
    } = useTodoState()

    // ç­›é€‰æ•°æ®ã€ä¸€é”®å…¨éƒ¨å®Œæˆ/æœªå®Œæˆã€æ¸…ç©ºå…¨éƒ¨å·²å®Œæˆäº‹é¡¹
    const {
      filteredTodos,
      remaining,
      allDone,
      filters,
      removeCompleted
    } = useFilterTodos(todos, visibility)


    // ç›‘å¬è·¯ç”±å“ˆå¸Œå˜åŒ–
    useHashChange(filters, visibility)


    return {
      todos,
      newTodo,
      filteredTodos,
      remaining,
      allDone,
      visibility,
      removeCompleted,
      addTodo,
      removeTodo,
    }
  },

})
```

`useTodoState`ä¸­åˆè°ƒç”¨äº†ä¸€ä¸ª`æœ¬åœ°å­˜å‚¨`é€»è¾‘ç›¸å…³çš„composition functionï¼š`useTodoStorage.ts`

`useTodoState.ts`:

```ts
import { Todo, Visibility } from "@/Types/TodoMVC";
import { ref, watchEffect, } from "vue"
import useTodoStorage from "@/views/TodoMVC/useTodoStorage";

export default function useTodoState() {

    const { fetch, save, uid } = useTodoStorage()

    // å…¨éƒ¨äº‹é¡¹
    const todos = ref(fetch())
    
    // å³å°†æ–°å¢äº‹é¡¹çš„å†…å®¹
    const newTodo = ref("")

    // æ–°å¢ä»£åŠäº‹é¡¹
    const addTodo = () => {
        const value = newTodo.value && newTodo.value.trim()
        if (!value) {
            return;
        }
        todos.value.push({
            id: uid.value,
            title: value,
            completed: false
        })
        uid.value += 1
        newTodo.value = ""
    }

    // åˆ é™¤ä»£åŠäº‹é¡¹
    const removeTodo = (todo: Todo) => {
        todos.value.splice(todos.value.indexOf(todo), 1)
    }

    // ä½¿ç”¨todos.valueçš„å‰¯ä½œç”¨å»åŠ¨æ€ä¿å­˜ä»£åŠäº‹é¡¹åˆ°æœ¬åœ°ç¼“å­˜ä¸­
    watchEffect(() => {
        save(todos.value)
    })

    // å½“å‰ç­›é€‰çš„ç±»å‹ï¼ˆurlçš„hashå€¼ä¸æ­¤å€¼ä¸€è‡´ï¼‰
    const visibility = ref<Visibility>("all")
    
    return {
        todos,
        newTodo,
        visibility,
        addTodo,
        removeTodo
    }
}
```



ç”¨äºæœ¬åœ°ç¼“å­˜çš„`useTodoStorage.ts`ï¼š

```ts
import {Todo} from "@/Types/TodoMVC";
import {ref, watchEffect} from "vue"


export default function useTodoStorage() {

    const STORAGE_KEY = 'TodoMVCâ€”â€”Vue3.0'


    // è·å–LocalStorageä¸­çš„æ•°æ®
    const fetch = (): Todo[] => JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

    // æ•°æ®å­˜å‚¨åˆ°LocalStorageä¸­
    const save = (todos: Todo[]) => {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(todos))
    }

    // ç”¨äºæ–°å¢ä»£åŠäº‹é¡¹çš„idè‡ªåŠ¨ç”Ÿæˆ
    const uid = ref(~~(localStorage.getItem('uid') || 0));
    watchEffect(() => localStorage.setItem('uid', uid.value.toString()))

    return {
        fetch,
        save,
        uid
    }

}
```

å…¶ä»–å°±ä¸ä¸€ä¸€å±•ç¤ºäº†ï¼Œä»£ç æœ€ç»ˆéƒ½æ”¾åœ¨æ–‡æœ«çš„é“¾æ¥ä¸­çš„**github**ä»“åº“é‡Œäº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥ç»†å“ã€‚è¿™ä¸ªdemoå› ä¸ºå†™å¾—æ¯”è¾ƒä»“ä¿ƒï¼Œè‡ªæˆ‘æ„Ÿè§‰å†™å¾—ä¸å’‹æ»´ï¼Œé€»è¾‘çš„ç»„ç»‡æœ‰å¾…å•†æ¦·ï¼Œè¿™ä¹Ÿä»ä¾§é¢å±•ç¤ºäº†composition APIç»™æˆ‘ä»¬å¸¦æ¥çš„**é«˜çµæ´»ç»„ç»‡å’Œå¤ç”¨èƒ½åŠ›**ï¼Œè‡³äºå¦‚ä½•æŠŠä»£ç ç»„ç»‡å¾—æ›´æ¼‚äº®å°±æ˜¯å¼€å‘è€…è‡ªå·±çš„äº‹äº†ï¼Œæˆ‘ä¹Ÿåœ¨è¯•å›¾æ…¢æ…¢æ‘¸ç´¢å‡ºå†™å¾—æ›´èˆ’æœçš„**æœ€ä½³å®è·µ**ã€‚

### ä¸React Hookså¯¹æ¯”

* åŒæ ·çš„é€»è¾‘ç»„åˆã€å¤ç”¨èƒ½åŠ›
* åªè°ƒç”¨ä¸€æ¬¡
  * ç¬¦åˆ JS ç›´è§‰
  * æ²¡æœ‰é—­åŒ…å˜é‡é—®é¢˜
  *  æ²¡æœ‰å†…å­˜/GC å‹åŠ› 
  * ä¸å­˜åœ¨å†…è”å›è°ƒå¯¼è‡´å­ç»„ä»¶æ°¸è¿œæ›´æ–°çš„é—®é¢˜

ä¸å¯ç½®å¦ï¼ŒComposition APIçš„è¯ç”Ÿç¡®å®å—åˆ°äº†React Hooksçš„å¯å‘ï¼Œå¦‚æœå› æ­¤å°±è´´ä¸ŠæŠ„è¢­çš„æ ‡ç­¾å°±æœªå…å¤ªæµäºè¡¨é¢äº†ï¼Œä¹Ÿä¸æƒ³åœ¨æ­¤å»å¼•æˆ˜ã€‚æ¡†æ¶éƒ½æ˜¯å¥½æ¡†æ¶ï¼Œå‰ç«¯åœˆå†…è¦**ä»¥å’Œä¸ºè´µ**ï¼Œäº’ç›¸å€Ÿé‰´å­¦ä¹ éš¾é“ä¸å¥½å—ï¼Œä¸è¦æçªé‡Œæ–—ã€‚

äº‹å®ä¸Šï¼ŒComposition APIçš„**å®ç°ä¸ä½¿ç”¨æ–¹å¼**ä¹Ÿéƒ½æ˜¯**æˆªç„¶ä¸åŒ**çš„ï¼Œæ‡‚å¾—è‡ªç„¶æ‡‚ã€‚

ä¸React Hooksçš„å¯¹æ¯”ä¹Ÿå·²ç»æœ‰ä¸å°‘æ–‡ç« è¯´å¾—æŒºè¯¦ç»†äº†ï¼Œè¿™é‡Œå°±ä¸å†è¿›è¡Œèµ˜è¿°ã€‚

ç®€å•æ¥è¯´å°±æ˜¯å¾—ç›Šäº**å“åº”å¼ç³»ç»Ÿ**ï¼ŒComposition API ä½¿ç”¨çš„**å¿ƒæ™ºè´Ÿæ‹…**ç›¸æ¯”ä¹‹ä¸‹å®åœ¨æ˜¯å°å¤ªå¤šäº†ã€‚



## Fragment

è¿™ä¸ªæ–°ç‰¹æ€§æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯åœ¨æ¨¡æ¿ä¸­å¯ä»¥å†™**å¤šä¸ªæ ¹èŠ‚ç‚¹**ã€‚è‡³äºå®ƒçš„æ„ä¹‰ï¼š

* å‡å°‘æ— æ„ä¹‰çš„æ ¹èŠ‚ç‚¹å…ƒç´ 
* å¯ä»¥**å¹³çº§é€’å½’**ç»„ä»¶

ç¬¬äºŒä¸ªæ„ä¹‰æ¯”è¾ƒé‡è¦ï¼Œåˆ©ç”¨è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œæ¯”å¦‚å¯ä»¥å†™ä¸€ä¸ªéªšæ°”çš„**å¿«é€Ÿæ’åºç»„ä»¶**ã€‚

`QuickSort.vue`:

```ts
<template>
  <quick-sort :list="left" v-if="left.length"></quick-sort>
  <span class="item">{{ flag }}</span>
  <quick-sort :list="right" v-if="right.length"></quick-sort>
</template>


<script lang="ts">
import {defineComponent, ref} from "vue"

export default defineComponent({
  name: 'quick-sort',
  props: ["list"],
  setup(props) {
    // eslint-disable-next-line vue/no-setup-props-destructure
    const flag: number = props.list[0]
    const left = ref<number[]>([])
    const right = ref<number[]>([])

    setTimeout(() => {
      props.list.slice(1).forEach((item: number) => {
        item > flag ? right.value.push(item) : left.value.push(item)
      })
    }, 100)

    return {
      flag,
      left,
      right
    }
  }
})
</script>
```

åœ¨é¡µé¢ç»„ä»¶`Fragment.vue`ä¸­ä½¿ç”¨ï¼š

```vue
<template>
  <h1>å¿«é€Ÿæ’åº</h1>
  <h2>
    {{ list }}
  </h2>
  <div>
    <button @click="ok = !ok">SORT</button>
  </div>
  <hr>
  <template v-if="ok">
    <QuickSort :list="list"></QuickSort>
  </template>
</template>

<script lang="ts">
import QuickSort from "@/components/QuickSort.vue";
import {defineComponent, ref} from "vue"
import {shuffle} from "lodash"

export default defineComponent({
  components: {
    QuickSort
  },
  setup() {
    const ok = ref(false)
    const list = ref<number[]>([])
    for (let i = 1; i < 20; i++){
      list.value.push(i)
    }
    list.value = shuffle(list.value)
    return {list, ok}
  }
})
</script>
```

å‘`QuickSort`ä¸­ä¼ å…¥ä¸€ä¸ªé•¿åº¦ä¸º20è¢«æ‰“ä¹±é¡ºåºçš„**æ•°ç»„**ï¼š

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5c06e43d83a74d48858e5d5b4136b87f~tplv-k3u1fbpfcp-watermark.image)

å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªé€’å½’çš„ç»„ä»¶éƒ½æ˜¯**å¹³çº§**çš„ï¼š
![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9eec3d53cdb54ae8b14af4e48b83c472~tplv-k3u1fbpfcp-watermark.image)

è€Œåœ¨Vue2ä¸­çš„é€’å½’ç»„ä»¶å¾€å¾€æ˜¯**å±‚å±‚åµŒå¥—**çš„ï¼Œå› ä¸ºå®ƒåªèƒ½å­˜åœ¨ä¸€ä¸ªæ ¹å…ƒç´ ï¼ŒåŒæ ·çš„å†™æ³•åœ¨Vue2ä¸­å°†ä¼šæŠ¥é”™ã€‚

åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™ä¸€ä¸ªå¹²å‡€çš„**æ ‘ç»„ä»¶**ç­‰ç­‰äº†ã€‚



## Suspense

å¯ä»¥ç†è§£ä¸º**å¼‚æ­¥ç»„ä»¶çš„çˆ¹**ã€‚ç”¨äºæ–¹ä¾¿åœ°æ§åˆ¶å¼‚æ­¥ç»„ä»¶çš„ä¸€ä¸ª**æŒ‚èµ·**å’Œ**å®Œæˆ**çŠ¶æ€ã€‚

ç›´æ¥ä¸Šä»£ç ï¼Œ

é¦–å…ˆæ˜¯ä¸€ä¸ªå¼‚æ­¥ç»„ä»¶ï¼Œ`AsyncComponent.vue`ï¼š

```vue
<template>
  <h2>AsyncComponent</h2>
</template>
<script lang="ts">
import {defineComponent} from "vue"

export default defineComponent({
  props: {
    timeout:{
      type: Number,
      required: true
    }
  },
  async setup(props) {
    const sleep = (timeout: number) => {
      return new Promise(resolve => {
        setTimeout(resolve, timeout)
      })
    }
    await sleep(props.timeout)
  }
})
</script>
```

åœ¨é¡µé¢ç»„ä»¶`Suspense.vue`ä¸­ï¼š

```vue
<template>
  <h1>Suspense</h1>
  <Suspense>
    <template #default>
      <AsyncComponent :timeout="5000"/>
    </template>

    <template #fallback>
      <p class="loading">loading {{ loadingStr }}</p>
    </template>
  </Suspense>
</template>

<script lang="ts">
import {defineComponent} from "vue"
import AsyncComponent from "@/components/AsyncComponent.vue"
import useLoading from "@/composables/useLoading";

export default defineComponent({
  components: {
    AsyncComponent
  },
  setup() {
    const {loading: loadingStr} = useLoading()
    return {loadingStr}
  }
})
</script>
```

ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç”¨Vue3æä¾›çš„å†…ç½®ç»„ä»¶ï¼š`Suspense`å°†å¼‚æ­¥ç»„ä»¶åŒ…èµ·æ¥ï¼Œ`template #default`ä¸­å±•ç¤ºåŠ è½½å®Œæˆçš„å¼‚æ­¥ç»„ä»¶ï¼Œ`template #fallback`ä¸­åˆ™å±•ç¤ºå¼‚æ­¥ç»„ä»¶æŒ‚èµ·çŠ¶æ€æ—¶éœ€è¦æ˜¾ç¤ºçš„å†…å®¹ã€‚

çœ‹çœ‹æ•ˆæœï¼š

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/32bb81fb97554daf8598f62c6e1bfa2a~tplv-k3u1fbpfcp-watermark.image)

## Teleport

ç†è§£ä¸º**ç»„ä»¶ä»»æ„é—¨**ï¼Œè®©ä½ çš„ç»„ä»¶å¯ä»¥ä»»æ„åœ°ä¸¢åˆ°htmlä¸­çš„ä»»ä¸€ä¸ªDOMä¸‹ã€‚åœ¨reactä¸­ä¹Ÿæœ‰ç›¸åŒåŠŸèƒ½çš„ç»„ä»¶â€”â€”**Portal**ï¼Œä¹‹æ‰€ä»¥æ”¹åå«**Teleport**æ˜¯ç”±äº**html**ä¹Ÿå‡†å¤‡æä¾›ä¸€ä¸ªåŸç”Ÿçš„protalæ ‡ç­¾ï¼Œä¸ºäº†é¿å…é‡åå°±å«åšTeleprotäº†ã€‚

åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åšçš„äº‹æƒ…å°±æ¯”è¾ƒæœ‰æƒ³è±¡ç©ºé—´äº†ã€‚ä¾‹å¦‚ï¼Œå†™ä¸€ä¸ª`Ball`ç»„ä»¶ï¼Œè®©å®ƒåœ¨ä¸åŒçš„çˆ¶ç»„ä»¶ä¸­å‘ˆç°ä¸ä¸€æ ·çš„æ ·å¼ç”šè‡³æ˜¯é€»è¾‘ï¼Œè¿™äº›**æ ·å¼**å’Œ**é€»è¾‘**å¯ä»¥å†™åœ¨çˆ¶ç»„ä»¶ä¸­ï¼Œè¿™æ ·å½“è¿™ä¸ªBallç»„ä»¶è¢«ä¼ é€åˆ°æŸä¸ªçˆ¶ç»„ä»¶ä¸­ï¼Œå°±å¯ä»¥å°†çˆ¶ç»„ä»¶å¯¹å…¶å®šä¹‰çš„æ ·å¼å’Œé€»è¾‘åº”ç”¨åˆ°Ballç»„ä»¶ä¸­äº†ã€‚å†ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨ä»»æ„å±‚çº§çš„ç»„ä»¶ä¸­å†™ä¸€ä¸ªéœ€è¦æŒ‚è½½åˆ°å¤–é¢å»çš„å­ç»„ä»¶ï¼Œæ¯”å¦‚ä¸€ä¸ª**Modalå¼¹çª—**ï¼Œè™½ç„¶æŒ‚è½½åœ¨å½“å‰ç»„ä»¶ä¸‹ä¹Ÿå¯ä»¥è¾¾åˆ°æ•ˆæœï¼Œä½†æ˜¯æœ‰æ—¶å€™å½“å‰ç»„ä»¶çš„æ ¹èŠ‚ç‚¹çš„æ ·å¼å¯èƒ½ä¼šä¸ä¹‹å‘ç”Ÿä¸€äº›å¹²æ‰°æˆ–è€…å†²çªã€‚

è¿™é‡Œï¼Œæˆ‘å†™äº†ä¸€ä¸ªModalå¼¹çª—çš„demoï¼š

```vue
<template>
  <h1>Teleportâ€”â€”ä»»æ„é—¨</h1>
  <div class="customButton" @click="handleToggle">å·è¢­</div>
  <teleport to="body">
    <TeleportModal v-if="isOpen" @click="handleToggle"></TeleportModal>
  </teleport>
</template>

<script lang="ts">
import {defineComponent, ref} from "vue"
import TeleportModal from "@/components/TeleportModal.vue"

export default defineComponent({
  components: {
    TeleportModal
  },
  setup() {
    const isOpen = ref(false)
    const handleToggle = () => {
      isOpen.value = !isOpen.value
    }

    return {
      isOpen,
      handleToggle
    }
  }
})
</script>
```

ç”¨Vue3å†…ç½®çš„`Teleport`ç»„ä»¶å°†éœ€è¦è¢«ä¼ é€çš„Modalç»„ä»¶åŒ…èµ·æ¥ï¼Œå†™å¥½è¦è¢«ä¼ é€åˆ°çš„å…ƒç´ é€‰æ‹©å™¨ã€‚ï¼ˆæœ‰ç‚¹åƒ**å¯„å¿«é€’**ï¼Œç”¨å¿«é€’ç›’æ‰“åŒ…å¥½ï¼Œå†™ä¸Šæ”¶è´§åœ°å€ï¼Œèµ·é£ï¼‰

çœ‹çœ‹è¿™ä¸ªdemoçš„æ•ˆæœï¼š
![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/720ed26754b8446387d6bb09eabb4a6b~tplv-k3u1fbpfcp-watermark.image)
![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/63f846d72d8d4e0d8b66cb97e06099b4~tplv-k3u1fbpfcp-watermark.image)

å¯ä»¥çœ‹åˆ°ï¼Œé©¬ä¿å›½ç¡®å®è¢«è¸¢åˆ°bodyä¸‹é¢å»äº†(ğŸ¶)ã€‚



## createRenderer API

åˆ©ç”¨è¿™ä¸ªAPIï¼Œåœ¨Vue3ä¸­æˆ‘ä»¬å¯ä»¥è‡ªç”±æ–¹ä¾¿åœ°å»æ„å»º**Webï¼ˆæµè§ˆå™¨ï¼‰å¹³å°**æˆ–**éWebå¹³å°**çš„**è‡ªå®šä¹‰æ¸²æŸ“å™¨**ã€‚

åŸç†å¤§æ¦‚å°±æ˜¯ï¼šå°†**Virtual DOM**å’Œ**å¹³å°ç›¸å…³**çš„æ¸²æŸ“**åˆ†ç¦»**ï¼Œé€šè¿‡**createRendererAPI**æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰Virtual DOMæ¸²æŸ“åˆ°æŸä¸€å¹³å°ä¸­æ—¶çš„æ‰€æœ‰**æ“ä½œ**ï¼Œæ¯”å¦‚**æ–°å¢**ã€**ä¿®æ”¹**ã€**åˆ é™¤**ä¸€ä¸ªâ€œå…ƒç´ â€ï¼Œæˆ‘ä»¬å¯ä»¥è¿™äº›æ–¹æ³•ä¸­æ›¿æ¢æˆ–ä¿®æ”¹ä¸ºæˆ‘ä»¬**è‡ªå®šä¹‰çš„é€»è¾‘**ï¼Œä»è€Œæ‰“é€ ä¸€ä¸ªæˆ‘ä»¬**è‡ªå®šä¹‰çš„æ¸²æŸ“å™¨**ã€‚

å½“ç„¶ï¼Œåœ¨**webå¹³å°**ä¸‹æ˜¯ç›¸å¯¹æ¯”è¾ƒç®€å•çš„ï¼Œå› ä¸ºå¯ä»¥åˆ©ç”¨Vueçš„`runtime-dom`ç»™æˆ‘ä»¬æä¾›çš„ä¸€ä¸ªä¸Šå±‚çš„**æŠ½è±¡å±‚**ï¼Œå®ƒå¸®æˆ‘ä»¬å®Œæˆäº†Virtual DOMæ¸²æŸ“åˆ°Web DOMä¸­çš„å¤**æ‚æµè§ˆå™¨æ¥å£ç¼–ç¨‹æ“ä½œ**ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨**createRenderer**çš„å‚æ•°ä¸­ä¼ å…¥ä¸€äº›**è‡ªå®šä¹‰çš„é€»è¾‘æ“ä½œ**å³å¯è‡ªåŠ¨å®Œæˆæ•´åˆï¼Œæ¯”å¦‚ä½ å¯ä»¥åœ¨`createElement`æ–¹æ³•ä¸­åŠ ä¸€æ®µè‡ªå·±çš„é€»è¾‘ï¼š
![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/584674e535da4017a2fa0d11b732c3da~tplv-k3u1fbpfcp-watermark.image)
è¿™æ ·åœ¨æ¯æ¬¡**åˆ›å»ºæ–°å…ƒç´ **çš„æ—¶å€™éƒ½ä¼šè·Ÿä½ â€œæ‰“æ‹›å‘¼â€ã€‚

è°ƒç”¨**createRenderer**ä»¥åçš„è¿”å›å€¼æ˜¯ä¸€ä¸ª**renderer**ï¼Œ**createApp**è¿™ä¸ªæ–¹æ³•å°±æ˜¯è¿™ä¸ªrendererçš„ä¸€ä¸ªå±æ€§æ–¹æ³•ï¼Œç”¨å®ƒæ›¿ä»£åŸç”Ÿçš„createAppæ–¹æ³•å°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„**è‡ªå®šä¹‰æ¸²æŸ“å™¨**äº†~

ä¸ºæ­¤ï¼Œæˆ‘å‡†å¤‡äº†ä¸€ä¸ªç”¨**Three.js**å’Œè‡ªå®šä¹‰æ¸²æŸ“å™¨å®ç°çš„**3Dæ–¹**å—demoï¼Œå¹¶ä¸”ç”¨**composition API**å°†æˆ‘ä»¬ä¹‹å‰å†™çš„ä¾¦å¬é¼ æ ‡ä½ç½®çš„é€»è¾‘å¤ç”¨è¿‡æ¥ï¼Œè®©è¿™ä¸ª3Dæ–¹å—è·Ÿç€æˆ‘ä»¬çš„é¼ æ ‡æ—‹è½¬ã€‚

é¦–å…ˆï¼Œå†™ä¸€ä¸ª**è‡ªå®šä¹‰æ¸²æŸ“å™¨**ï¼š`renderer.js`:

```js
import { createRenderer } from '@vue/runtime-dom'
import * as THREE from 'three'

let webGLRenderer

// Three.jsç›¸å…³
function draw(obj) {
    const {camera,cameraPos, scene, geometry,geometryArg,material,mesh,meshY,meshX} = obj
    if([camera,cameraPos, scene, geometry,geometryArg,material,mesh,meshY,meshX].filter(v=>v).length<9){
        return
    }
    let cameraObj = new THREE[camera]( 40, window.innerWidth / window.innerHeight, 0.1, 10 )
    Object.assign(cameraObj.position,cameraPos)

    let sceneObj = new THREE[scene]()

    let geometryObj = new THREE[geometry]( ...geometryArg)
    let materialObj = new THREE[material]()

    let meshObj = new THREE[mesh]( geometryObj, materialObj )
    meshObj.rotation.x = meshX
    meshObj.rotation.y = meshY
    sceneObj.add( meshObj )
    webGLRenderer.render( sceneObj, cameraObj );
}

const { createApp } = createRenderer({
      insert: (child, parent, anchor) => {
          if(parent.domElement){
              draw(child)
          }
      },
      createElement:(type, isSVG, isCustom) => {
          alert('hi Channing~')
          return {
              type
          }
      },
      setElementText(node, text) {},
      patchProp(el, key, prev, next) {
          el[key] = next
          draw(el)
      },
      parentNode: node => node,
      nextSibling: node => node,
      createText: text => text,
      remove:node=>node
});


// å°è£…ä¸€ä¸ªè‡ªå®šä¹‰çš„createAppæ–¹æ³•
export function customCreateApp(component) {
  const app = createApp(component)
  return {
    mount(selector) {
        webGLRenderer = new THREE.WebGLRenderer( { antialias: true } );
        webGLRenderer.setSize( window.innerWidth, window.innerHeight );
        const parentElement =  document.querySelector(selector) || document.body
        parentElement.appendChild( webGLRenderer.domElement );
        app.mount(webGLRenderer)
    }
  }
}


```

`App.vue`ï¼Œè¿™é‡Œå†™ä¸€äº›å¯¹çœŸå®DOMçš„**æ“ä½œé€»è¾‘**ï¼Œæ¯”å¦‚æˆ‘æŠŠ`meshX`å’Œ`meshY`è®¾ç½®ä¸ºäº†è·å–é¼ æ ‡ä½ç½®è¿™ä¸ªcomposition function è¿”å›çš„é¼ æ ‡**x**å’Œ**y**çš„è®¡ç®—å±æ€§å€¼ï¼ˆä¸ºäº†å‡å°æ—‹è½¬çš„çµæ•åº¦ï¼‰ã€‚

```vue
<template>
  <div
      camera="PerspectiveCamera"
      :cameraPos={z:1}
      scene="Scene"
      geometry="BoxGeometry"
      :geometryArg="[0.2,0.2,0.2]"
      material="MeshNormalMaterial"
      mesh="Mesh"
      :meshY="y"
      :meshX="x"
  >
  </div>

</template>

<script>
import {computed} from 'vue'
import useMousePosition from "./useMousePosition";

export default {
  setup() {
    const {x: mouseX, y: mouseY} = useMousePosition()
    const x = computed(() => (mouseY.value)/200)
    const y = computed(() => (mouseX.value)/200)
    return {x,y}
  }
}
</script>
<style>

body {
  padding: 0;
  margin: 0;
  overflow: hidden;
}
</style>
```

æœ€åï¼Œåœ¨main.jsä¸­ä½¿ç”¨æˆ‘ä»¬åˆšåˆšåœ¨`renderer.js`ä¸­å°è£…çš„å¸¦æœ‰è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„`customCreateApp`æ–¹æ³•æ›¿æ¢æ™®é€šçš„**createApp**æ–¹æ³•ï¼Œå³å¯ï¼š

```js
import { customCreateApp } from './renderer';
import App from "./App.vue";

customCreateApp(App).mount("#app")
```

æˆ‘ä»¬çœ‹çœ‹æœ€ç»ˆçš„æ•ˆæœï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c3f28621d17143c886584828521ac3e3~tplv-k3u1fbpfcp-watermark.image)

å› ç¼ºæ€å…ï¼





## One more thing â€”â€” Vite

æœ€åï¼Œå·ç§°é¢å‘æœªæ¥çš„æ„å»ºå·¥å…·**Vite**ã€‚

`yarn dev` å•ªåœ°ä¸€ä¸‹åº”ç”¨å°±èµ·æ¥äº†ï¼Œå¾ˆ**å¿«**å•Šã€‚

å®ƒçš„åŸç†å°±æ˜¯ä¸€ä¸ªåŸºäºæµè§ˆå™¨åŸç”Ÿ **ES imports** çš„å¼€å‘æœåŠ¡å™¨ã€‚åˆ©ç”¨**æµè§ˆå™¨**å»**è§£æ** importsï¼Œåœ¨æœåŠ¡å™¨ç«¯**æŒ‰éœ€ç¼–è¯‘**è¿”å›ï¼Œå®Œå…¨è·³è¿‡äº†**æ‰“åŒ…**è¿™ä¸ªæ¦‚å¿µï¼ŒæœåŠ¡å™¨éšèµ·éšç”¨ã€‚æ”¯æŒ **.vueæ–‡ä»¶** å’Œ**çƒ­æ›´æ–°**ï¼Œå¹¶ä¸”çƒ­æ›´æ–°çš„**é€Ÿåº¦**ä¸ä¼šéšç€æ¨¡å—å¢å¤šè€Œå˜æ…¢ã€‚

å½“ç„¶ï¼Œ**ç”Ÿäº§ç¯å¢ƒ**çš„æ„å»ºè¿˜æ˜¯ä½¿ç”¨çš„**rollup**è¿›è¡Œæ‰“åŒ…ã€‚å®ƒçš„é¦™æ˜¯åœ¨äº**å¼€å‘ç¯å¢ƒ**çš„è°ƒè¯•é€Ÿåº¦ã€‚

ä¸ºäº†æ›´å¥½åœ°ç†è§£å®ƒçš„å·¥ä½œåŸç†ï¼Œæˆ‘æ‰¾äº†èœ—ç‰›è€æ¹¿ç”»çš„ä¸€å¼ å›¾ï¼š
![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/13cfa102fedb416990e6f348aeb607e6~tplv-k3u1fbpfcp-watermark.image)

ç„¶åï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªviteçš„æ¼”ç¤ºdemoï¼Œç”¨æ¥çœ‹çœ‹**Vite**æ˜¯æ€ä¹ˆå¤„ç†æˆ‘ä»¬çš„æ–‡ä»¶çš„ã€‚

```
yarn create vite-app vite-demo
cd vite-demo && yarn && yarn dev
```

æ‰“å¼€**http://localhost:3000/**

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/237485007ef24e8e875c755f3705bd75~tplv-k3u1fbpfcp-watermark.image)
çœ‹åˆ°localhostçš„è¯·æ±‚ç»“æœï¼Œä¾ç„¶æ˜¯ä¿ç•™äº†**ES Module**ç±»å‹çš„ä»£ç 

ç„¶åViteçš„æœåŠ¡å™¨æ‹¦æˆªåˆ°ä½ å¯¹`main.js`çš„è¯·æ±‚ï¼Œç„¶åè¿”å›main.jsçš„å†…å®¹ç»™ä½ ï¼Œé‡Œé¢ä¾ç„¶æ˜¯**ES Module**çš„ç±»å‹ï¼Œ

åˆæ‹¦æˆªåˆ°`vue.js`ã€`App.vue`ï¼Œç»§ç»­è¿”å›ç›¸åº”çš„å†…å®¹ç»™ä½ ï¼Œå¦‚æ­¤ç±»æ¨â€¦â€¦

æ‰€ä»¥Viteåº”ç”¨å¯åŠ¨çš„è¿‡ç¨‹å®Œå…¨è·³è¿‡äº†**æ‰“åŒ…ç¼–è¯‘**ï¼Œè®©ä½ çš„åº”ç”¨ç§’èµ·ã€‚æ–‡ä»¶çš„çƒ­æ›´æ–°ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ¯”å¦‚å½“ä½ ä¿®æ”¹äº†**App.vue**çš„å†…å®¹ï¼Œå®ƒåˆæ‹¦æˆªç»™ä½ è¿”å›ä¸€ä¸ªæ–°çš„**ç¼–è¯‘è¿‡å**çš„App.vueæ–‡ä»¶ï¼š

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d2c0d9d72cf14f9d8a6322319cdb73ec~tplv-k3u1fbpfcp-watermark.image)


å¯¹äºå¤§å‹çš„é¡¹ç›®æ¥è¯´ï¼Œè¿™ç§æ¯«ç§’çº§çš„å“åº”å®åœ¨æ˜¯å¤ªèˆ’æœäº†ã€‚å»å¹´å‚ä¸è¿‡ä¸€ä¸ªå†…éƒ¨ç»„ä»¶åº“çš„å¼€å‘å·¥ä½œï¼Œå½“æ—¶æ˜¯ä¿®æ”¹çš„**webpack**æ’ä»¶ï¼Œæ¯æ¬¡ä¿®æ”¹éƒ½å¾—é‡å¯é¡¹ç›®ï¼Œæ¯æ¬¡é‡å¯å°±æ˜¯**å››äº”åˆ†é’Ÿ**å¾€ä¸Šï¼Œç®€ç›´æ„Ÿè§‰äººè¦è£‚å¼€ã€‚

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/48b855ced99a48eeabda7b02d5021fe6~tplv-k3u1fbpfcp-watermark.image)

å½“ç„¶ï¼Œä¹Ÿä¸è‡³äºåˆ°å¯ä»¥å®Œå…¨**å–ä»£**Webpackçš„å¤¸å¼ åœ°æ­¥ï¼Œå› ä¸º**Vite**è¿˜æ˜¯åœ¨**å¼€å‘é˜¶æ®µ**ï¼Œè®¸å¤š**å·¥ç¨‹åŒ–**çš„éœ€æ±‚è¿˜æ˜¯éš¾ä»¥æ»¡è¶³çš„ï¼Œæ¯”å¦‚Webpackä¸°å¯Œçš„å‘¨è¾¹**æ’ä»¶**ç­‰ç­‰ã€‚



# å†™åœ¨æœ€å
> æ€»ç®—æ˜¯è‚å®Œäº†ä¸‡å­—é•¿æ–‡ï¼ŒçœŸçš„å¯å¤ªéš¾äº†ã€‚<br/>
> å½“ç„¶ï¼Œæ–‡ä¸­å¯èƒ½ä¼šå­˜åœ¨æˆ–å¤šæˆ–å°‘çš„ä¸è¶³ã€é”™è¯¯ä¹‹å¤„ï¼Œå¦‚æœæœ‰å»ºè®®æˆ–è€…æ„è§éå¸¸æ¬¢è¿å¤§å®¶åœ¨**è¯„è®º**äº¤æµã€‚<br/>
> æ–‡ä¸­æ‰€ç”¨çš„æ‰€æœ‰Demoéƒ½æ”¾åœ¨è¿™ä¸ªä»“åº“ä¸‹ï¼š[GitHubä¼ é€é—¨](https://github.com/ChanningHan/talk-about-vue3)ã€‚<br/>
> æœ€åï¼Œæ„Ÿè°¢å¤§å®¶å¯ä»¥è€å¿ƒåœ°è¯»åˆ°è¿™é‡Œï¼Œå¦‚æœé¡ºæ‰‹çš„è¯å¸Œæœ›å¯ä»¥**ç‚¹èµ**è¯„è®ºå…³æ³¨ä¸‰è¿ï¼Œå› ä¸ºè¿™äº›å°±æ˜¯æˆ‘åˆ†äº«çš„å…¨éƒ¨**åŠ¨åŠ›**æ¥æºğŸ™ğŸ™ğŸ™ã€‚